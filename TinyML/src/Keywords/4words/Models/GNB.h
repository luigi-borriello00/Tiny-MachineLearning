#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[4] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 1557.9635; theta[1] = 1758.5665; theta[2] = 1727.378; theta[3] = 1662.34725; theta[4] = 1541.065166666668; theta[5] = 1492.829666666667; theta[6] = 1449.554333333334; theta[7] = 1371.903666666666; theta[8] = 1242.692583333333; theta[9] = 1040.868583333334; theta[10] = 902.599166666667; theta[11] = 745.467166666667; theta[12] = 648.5085; theta[13] = 548.756; theta[14] = 467.642; theta[15] = 392.813166666667; theta[16] = 332.3325; theta[17] = 296.880583333333; theta[18] = 264.840583333333; theta[19] = 260.01025; theta[20] = 236.86175; theta[21] = 229.230416666667; theta[22] = 227.521083333333; theta[23] = 216.81925; theta[24] = 216.22325; theta[25] = 205.320166666667; theta[26] = 206.086916666667; theta[27] = 205.085083333333; theta[28] = 211.830916666667; theta[29] = 207.625416666667; theta[30] = 203.15625; theta[31] = 211.313416666667;
                        sigma[0] = 423920.12995855924; sigma[1] = 463752.4942185592; sigma[2] = 405796.5964784759; sigma[3] = 405617.28814408; sigma[4] = 596880.6573274481; sigma[5] = 553466.472942365; sigma[6] = 607712.3934670317; sigma[7] = 717334.9149540316; sigma[8] = 630122.9470366354; sigma[9] = 534727.3354446357; sigma[10] = 563557.4474417815; sigma[11] = 490209.72648944805; sigma[12] = 457305.4090435593; sigma[13] = 345017.66053147573; sigma[14] = 257737.59896014247; sigma[15] = 194582.42321078142; sigma[16] = 141062.17700122582; sigma[17] = 95617.77736296892; sigma[18] = 80302.5098196356; sigma[19] = 70921.50124991339; sigma[20] = 62556.86872191338; sigma[21] = 59141.767004802256; sigma[22] = 64674.22973546895; sigma[23] = 65537.98267608004; sigma[24] = 70819.12157774669; sigma[25] = 72350.87258911473; sigma[26] = 70750.75006380225; sigma[27] = 64378.21847080226; sigma[28] = 60161.2458391356; sigma[29] = 56114.38670563558; sigma[30] = 52683.8175892467; sigma[31] = 47040.71479496893;
                        votes[0] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 1552.775416666667; theta[1] = 1713.321166666667; theta[2] = 1730.523916666666; theta[3] = 1643.51425; theta[4] = 1380.409166666666; theta[5] = 1113.30175; theta[6] = 908.441083333334; theta[7] = 798.804666666666; theta[8] = 772.82225; theta[9] = 788.102583333333; theta[10] = 981.567166666666; theta[11] = 1064.248416666667; theta[12] = 1181.899833333334; theta[13] = 1274.09575; theta[14] = 1302.098666666666; theta[15] = 1269.895666666666; theta[16] = 1282.560916666666; theta[17] = 1181.11; theta[18] = 1079.042333333333; theta[19] = 975.359916666667; theta[20] = 856.208833333333; theta[21] = 719.079583333334; theta[22] = 607.905833333334; theta[23] = 539.445583333333; theta[24] = 455.372333333333; theta[25] = 414.987083333333; theta[26] = 383.301416666666; theta[27] = 364.470666666667; theta[28] = 330.761083333333; theta[29] = 330.09675; theta[30] = 323.510166666667; theta[31] = 320.726916666667;
                        sigma[0] = 495645.0853189691; sigma[1] = 458167.30836611486; sigma[2] = 825219.8562363024; sigma[3] = 1062190.7707402466; sigma[4] = 854114.987168448; sigma[5] = 756490.7885652469; sigma[6] = 522188.90853713546; sigma[7] = 496011.5155440313; sigma[8] = 497241.0686332469; sigma[9] = 500761.8003216353; sigma[10] = 910612.0874377814; sigma[11] = 1143219.4841641355; sigma[12] = 1304263.4252707812; sigma[13] = 1403288.6349769137; sigma[14] = 1269286.4033573654; sigma[15] = 1235646.6201036982; sigma[16] = 1293968.455517469; sigma[17] = 1097305.5453841428; sigma[18] = 1043660.0745253648; sigma[19] = 886088.4483299688; sigma[20] = 763629.0410394485; sigma[21] = 589089.8885814691; sigma[22] = 425711.4571301148; sigma[23] = 340097.7847321356; sigma[24] = 259686.5011453648; sigma[25] = 265462.80551480234; sigma[26] = 305808.2121346356; sigma[27] = 255716.35716536478; sigma[28] = 173010.08491880223; sigma[29] = 157840.48243607997; sigma[30] = 156079.88938078147; sigma[31] = 141052.82475213564;
                        votes[1] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 2315.309833333333; theta[1] = 2394.981333333334; theta[2] = 2171.20825; theta[3] = 2031.480083333332; theta[4] = 1832.74025; theta[5] = 1617.25075; theta[6] = 1351.14575; theta[7] = 1155.505583333333; theta[8] = 989.295333333334; theta[9] = 775.639916666667; theta[10] = 631.784833333334; theta[11] = 568.2205; theta[12] = 515.802416666666; theta[13] = 471.175416666667; theta[14] = 420.66775; theta[15] = 404.318416666667; theta[16] = 388.452666666667; theta[17] = 363.218666666667; theta[18] = 322.87525; theta[19] = 297.770166666667; theta[20] = 315.813; theta[21] = 271.147833333333; theta[22] = 239.798916666666; theta[23] = 231.536666666667; theta[24] = 204.484916666667; theta[25] = 205.686; theta[26] = 203.092083333333; theta[27] = 195.26; theta[28] = 194.805833333333; theta[29] = 194.278666666667; theta[30] = 192.0925; theta[31] = 190.181666666667;
                        sigma[0] = 1218994.6805974485; sigma[1] = 1301791.7732640319; sigma[2] = 1404621.0268902476; sigma[3] = 1586322.5838449693; sigma[4] = 1528478.8522115794; sigma[5] = 1158109.7686860804; sigma[6] = 916099.5288735804; sigma[7] = 885763.3103338026; sigma[8] = 735877.2610706984; sigma[9] = 606519.2702083023; sigma[10] = 414112.66566078144; sigma[11] = 380565.3930488924; sigma[12] = 394174.27303580224; sigma[13] = 440830.47271896905; sigma[14] = 374727.50426658; sigma[15] = 406856.81392580224; sigma[16] = 393225.6512936981; sigma[17] = 335713.47092569806; sigma[18] = 250760.1694807467; sigma[19] = 250861.0263241148; sigma[20] = 273218.7681618092; sigma[21] = 195382.263724448; sigma[22] = 116796.49176880221; sigma[23] = 103880.15003636475; sigma[24] = 51434.18137080227; sigma[25] = 49988.0008848092; sigma[26] = 46422.65721396892; sigma[27] = 41848.81636747586; sigma[28] = 39655.915616781414; sigma[29] = 42005.24268236476; sigma[30] = 41611.87804289254; sigma[31] = 44776.90375303141;
                        votes[2] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 1804.667750000001; theta[1] = 1812.721833333334; theta[2] = 1837.2675; theta[3] = 1876.086166666666; theta[4] = 1796.6455; theta[5] = 1561.708166666666; theta[6] = 1417.446166666667; theta[7] = 1299.352083333333; theta[8] = 1170.431583333333; theta[9] = 1049.7865; theta[10] = 910.8685; theta[11] = 763.958583333333; theta[12] = 689.66125; theta[13] = 625.94175; theta[14] = 596.516333333333; theta[15] = 549.697; theta[16] = 527.959583333333; theta[17] = 481.71825; theta[18] = 459.41825; theta[19] = 419.556916666667; theta[20] = 359.595416666667; theta[21] = 328.96825; theta[22] = 321.779666666667; theta[23] = 286.591666666667; theta[24] = 268.547083333333; theta[25] = 261.1285; theta[26] = 241.96125; theta[27] = 245.799; theta[28] = 236.320666666667; theta[29] = 231.91025; theta[30] = 227.532416666667; theta[31] = 222.32525;
                        sigma[0] = 807490.1152732469; sigma[1] = 837089.4901057817; sigma[2] = 1026104.3495212261; sigma[3] = 1468936.5117827805; sigma[4] = 1596636.0258172264; sigma[5] = 1248713.0331907815; sigma[6] = 1138487.2367777813; sigma[7] = 980143.4751506355; sigma[8] = 748880.1739858023; sigma[9] = 639675.3611835595; sigma[10] = 549417.142640226; sigma[11] = 358664.0881513021; sigma[12] = 299658.60527341353; sigma[13] = 200458.02243357996; sigma[14] = 184854.90379569802; sigma[15] = 166830.12535347595; sigma[16] = 153512.51060813558; sigma[17] = 159259.72406858005; sigma[18] = 149544.1023002467; sigma[19] = 128747.9020271356; sigma[20] = 106407.65882230223; sigma[21] = 93181.33874524668; sigma[22] = 163020.53895903152; sigma[23] = 78811.07623969812; sigma[24] = 61098.671979802224; sigma[25] = 59928.36038855922; sigma[26] = 48977.81518008005; sigma[27] = 47412.578956475874; sigma[28] = 40737.47097036474; sigma[29] = 38746.64220491337; sigma[30] = 33657.262002468924; sigma[31] = 30774.768690746696;
                        votes[3] = 0.25 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 4; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }