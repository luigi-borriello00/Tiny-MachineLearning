#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -1.450233070757 ,-0.42141185414 ,-4.073682712085  };
                        votes[0] += dot(x,   -0.294383445697  , -0.308550988221  , -0.318833143948  , -0.295827965496  , -0.30185824277  , -0.298762472538  , -0.287680721369  , -0.300356502964  , -0.300443506351  , -0.309336755589  , -0.3065653512  , -0.324173483428  , -0.316551935254  , -0.302932380188  , -0.312271047439  , -0.334720098786  , -0.31712068785  , -0.338456439455  , -0.320697015529  , -0.332061414872  , -0.325892870607  , -0.327482262664  , -0.325997663984  , -0.308820449719  , -0.315072605145  , -0.328266377845  , -0.331793742842  , -0.334102356583  , -0.332304125603  , -0.33463915148  , -0.327918938099  , -0.358553825438 );
                        votes[1] += dot(x,   -0.295286190403  , -0.280959958505  , 0.221431761936  , 0.03707984933  , 0.120036295856  , -0.024479671154  , -0.059682647928  , -0.18675292635  , 0.04002744364  , -0.079089150875  , -0.025763798542  , -0.031639123231  , -0.297234439981  , -0.403851012236  , -0.006056431223  , 0.449273023595  , 0.205498951049  , 0.151086978025  , -0.146849207401  , 0.379367119656  , 0.320748026217  , -0.066678284259  , -0.202062069974  , 0.160708034326  , 0.280137419629  , 0.075308738731  , -0.115085096698  , -0.049454707718  , -0.119734647923  , -0.000998440752  , 0.142652064334  , 0.335560483295 );
                        votes[2] += dot(x,   0.182973944372  , 0.165827450436  , 0.138311380229  , 0.08744992686  , 0.106592186357  , 0.17929642748  , 0.110563216532  , 0.170112078914  , 0.107533691734  , 0.138768378528  , 0.108320729447  , 0.165259470752  , 0.199833717837  , 0.190238569314  , 0.142429383658  , 0.072120249926  , 0.071154578726  , 0.164947413231  , 0.139126815191  , 0.058862773731  , 0.141906771485  , 0.121474674649  , 0.198145408954  , 0.096771668841  , 0.141005801672  , 0.159523007862  , 0.214654368715  , 0.194017035183  , 0.222159200989  , 0.150854834851  , 0.156311738408  , 0.16269197835 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }