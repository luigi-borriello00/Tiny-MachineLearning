#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 0.27398409661; theta[1] = 0.200197744784; theta[2] = 0.106122283305; theta[3] = 0.076073797553; theta[4] = 0.122295837278; theta[5] = 0.134140764254; theta[6] = 0.248746230958; theta[7] = 0.355770078782; theta[8] = 0.335953839214; theta[9] = 0.279730493833; theta[10] = 0.241382931818; theta[11] = 0.185938783895; theta[12] = 0.162915578514; theta[13] = 0.075041191364; theta[14] = -0.005961416955; theta[15] = -0.055049602264; theta[16] = -0.130314234194; theta[17] = -0.087931709945; theta[18] = -0.071609215313; theta[19] = -0.046352740258; theta[20] = -0.019412906817; theta[21] = 0.033813953282; theta[22] = 0.093119047105; theta[23] = 0.166020641105; theta[24] = 0.202421657422; theta[25] = 0.180911678439; theta[26] = 0.315586535659; theta[27] = 0.280956052429; theta[28] = 0.363936639663; theta[29] = 0.305789003915; theta[30] = 0.23422613347; theta[31] = 0.115246310389;
                        sigma[0] = 0.924262584315; sigma[1] = 0.689563064168; sigma[2] = 0.462095347836; sigma[3] = 0.443786288877; sigma[4] = 0.519132547982; sigma[5] = 0.407822428971; sigma[6] = 0.473210764684; sigma[7] = 0.427899108966; sigma[8] = 0.41704269197; sigma[9] = 0.486116037476; sigma[10] = 0.574678269286; sigma[11] = 0.631722960163; sigma[12] = 0.490599970353; sigma[13] = 0.415571524633; sigma[14] = 0.296957834699; sigma[15] = 0.288152951521; sigma[16] = 0.241817551129; sigma[17] = 0.210899210225; sigma[18] = 0.335743649704; sigma[19] = 0.728560062346; sigma[20] = 1.097850564905; sigma[21] = 1.566758805604; sigma[22] = 1.492199101172; sigma[23] = 3.001025382676; sigma[24] = 3.616947493008; sigma[25] = 3.575698497554; sigma[26] = 5.030744442853; sigma[27] = 4.866373732509; sigma[28] = 5.717828818943; sigma[29] = 3.288513565894; sigma[30] = 1.387009302124; sigma[31] = 0.733322962394;
                        votes[0] = 0.333333333333 - gauss(x, theta, sigma);
                        theta[0] = 0.302731057173; theta[1] = 0.172600585065; theta[2] = 0.116386751; theta[3] = 0.096061021568; theta[4] = 0.03141893909; theta[5] = -0.110507512329; theta[6] = -0.146465802237; theta[7] = -0.034137254565; theta[8] = 0.004399119973; theta[9] = 0.091932569874; theta[10] = 0.379515321386; theta[11] = 0.642811805746; theta[12] = 0.795137536413; theta[13] = 1.042712797279; theta[14] = 1.096420196996; theta[15] = 1.219050918383; theta[16] = 1.349041781406; theta[17] = 1.394099239725; theta[18] = 1.464546506864; theta[19] = 1.451459245459; theta[20] = 1.52448263088; theta[21] = 1.544417977448; theta[22] = 1.358654558799; theta[23] = 1.411669195544; theta[24] = 1.253147160008; theta[25] = 1.067305055624; theta[26] = 1.086786357323; theta[27] = 0.909800957676; theta[28] = 0.838040352148; theta[29] = 0.786393697246; theta[30] = 0.800246522088; theta[31] = 0.783126153004;
                        sigma[0] = 1.506967863245; sigma[1] = 1.032502743553; sigma[2] = 0.92203699097; sigma[3] = 0.963364312096; sigma[4] = 0.779610132141; sigma[5] = 0.632818548674; sigma[6] = 0.601310948835; sigma[7] = 0.473406661823; sigma[8] = 0.475698158929; sigma[9] = 0.702099847119; sigma[10] = 1.151816055104; sigma[11] = 1.782197014075; sigma[12] = 1.554097288376; sigma[13] = 2.193534544202; sigma[14] = 2.026936543837; sigma[15] = 2.317996563221; sigma[16] = 2.503592115018; sigma[17] = 2.650887774364; sigma[18] = 2.979723214738; sigma[19] = 3.238596459149; sigma[20] = 4.538487510353; sigma[21] = 5.573072677761; sigma[22] = 5.120225041109; sigma[23] = 6.290118981228; sigma[24] = 6.308430454453; sigma[25] = 6.385352646341; sigma[26] = 7.029892397008; sigma[27] = 5.166782099176; sigma[28] = 3.673788358345; sigma[29] = 3.181869544674; sigma[30] = 3.287281442179; sigma[31] = 4.574096991185;
                        votes[1] = 0.333333333333 - gauss(x, theta, sigma);
                        theta[0] = 0.694379019611; theta[1] = 0.293480426318; theta[2] = 0.210283935292; theta[3] = 0.213727300779; theta[4] = 0.271997372888; theta[5] = 0.14582155951; theta[6] = 0.139311257183; theta[7] = 0.211516741147; theta[8] = 0.234077617424; theta[9] = 0.224777244332; theta[10] = 0.204541788636; theta[11] = 0.182381349098; theta[12] = 0.19303041948; theta[13] = 0.173720374261; theta[14] = 0.145785475924; theta[15] = 0.157070814127; theta[16] = 0.167263077948; theta[17] = 0.1955040952; theta[18] = 0.231907291469; theta[19] = 0.194373699736; theta[20] = 0.193419448276; theta[21] = 0.214109644337; theta[22] = 0.28310031445; theta[23] = 0.25714660652; theta[24] = 0.240322731634; theta[25] = 0.257663560053; theta[26] = 0.332985578819; theta[27] = 0.311088341517; theta[28] = 0.293269153366; theta[29] = 0.28042653229; theta[30] = 0.277899915579; theta[31] = 0.157114392367;
                        sigma[0] = 2.096198913061; sigma[1] = 1.321459303212; sigma[2] = 1.007240947132; sigma[3] = 1.200061387642; sigma[4] = 1.043246434476; sigma[5] = 0.620602657769; sigma[6] = 0.505775356618; sigma[7] = 0.374574558568; sigma[8] = 0.360468075328; sigma[9] = 0.37387861781; sigma[10] = 0.335515999835; sigma[11] = 0.343618212555; sigma[12] = 0.274914565048; sigma[13] = 0.254783534562; sigma[14] = 0.234164444615; sigma[15] = 0.288159248994; sigma[16] = 0.31619257635; sigma[17] = 0.352324575397; sigma[18] = 0.422231455018; sigma[19] = 0.428722679418; sigma[20] = 0.556831451006; sigma[21] = 0.650633840015; sigma[22] = 1.324312250402; sigma[23] = 0.821950651153; sigma[24] = 0.771136684258; sigma[25] = 0.812407567118; sigma[26] = 1.141540486769; sigma[27] = 0.923351821922; sigma[28] = 0.939623215793; sigma[29] = 0.86500602562; sigma[30] = 0.777873519156; sigma[31] = 0.623030147969;
                        votes[2] = 0.333333333333 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }