#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[4] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 0.103547340443; theta[1] = 0.093917857126; theta[2] = 0.038849168; theta[3] = 0.039340009289; theta[4] = 0.113588889412; theta[5] = 0.14794443683; theta[6] = 0.336291021644; theta[7] = 0.452066777584; theta[8] = 0.423412510234; theta[9] = 0.430382819592; theta[10] = 0.337735470519; theta[11] = 0.30071263936; theta[12] = 0.219919367125; theta[13] = 0.07773267777; theta[14] = 0.025064017327; theta[15] = 0.009713459852; theta[16] = -0.035768914954; theta[17] = -0.000633336183; theta[18] = 0.036832794012; theta[19] = 0.076381224013; theta[20] = 0.113303844845; theta[21] = 0.154984392734; theta[22] = 0.207639764415; theta[23] = 0.291380685223; theta[24] = 0.380211239515; theta[25] = 0.406800354325; theta[26] = 0.466641228216; theta[27] = 0.533018811443; theta[28] = 0.580708944194; theta[29] = 0.493026100511; theta[30] = 0.357420689512; theta[31] = 0.179629606019;
                        sigma[0] = 0.406377315753; sigma[1] = 0.493105409973; sigma[2] = 0.333381905058; sigma[3] = 0.31979666025; sigma[4] = 0.310736489296; sigma[5] = 0.328060720549; sigma[6] = 0.408672710822; sigma[7] = 0.332651585938; sigma[8] = 0.333722102931; sigma[9] = 0.529485390344; sigma[10] = 0.614591820712; sigma[11] = 0.740379039862; sigma[12] = 0.613270286692; sigma[13] = 0.394307508915; sigma[14] = 0.237755811612; sigma[15] = 0.237647601591; sigma[16] = 0.218058101147; sigma[17] = 0.246155760828; sigma[18] = 0.513029635532; sigma[19] = 1.285111279571; sigma[20] = 2.098674933259; sigma[21] = 2.887377871489; sigma[22] = 2.811628485707; sigma[23] = 5.47462902082; sigma[24] = 7.577538520658; sigma[25] = 8.480338609052; sigma[26] = 10.189335066016; sigma[27] = 11.558809185977; sigma[28] = 12.426235012385; sigma[29] = 7.951546157865; sigma[30] = 3.355743922655; sigma[31] = 0.950764398074;
                        votes[0] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.136633153416; theta[1] = 0.003476743972; theta[2] = 0.089725738437; theta[3] = 0.063972327673; theta[4] = 0.033010990532; theta[5] = -0.131398654849; theta[6] = -0.113130971147; theta[7] = -0.046148297017; theta[8] = 0.006311910784; theta[9] = 0.135412673884; theta[10] = 0.606054584108; theta[11] = 0.994152666775; theta[12] = 1.241545055218; theta[13] = 1.462556873134; theta[14] = 1.709108831714; theta[15] = 1.842996595801; theta[16] = 1.918501945452; theta[17] = 1.882406300165; theta[18] = 2.008070658146; theta[19] = 2.102490724833; theta[20] = 2.367600933073; theta[21] = 2.373628862574; theta[22] = 2.090490242398; theta[23] = 2.079706590847; theta[24] = 1.940735736039; theta[25] = 1.680393836614; theta[26] = 1.468327866907; theta[27] = 1.241531258606; theta[28] = 0.977079068701; theta[29] = 0.994759639801; theta[30] = 0.98590167681; theta[31] = 0.915412942681;
                        sigma[0] = 0.646348758493; sigma[1] = 0.719534553645; sigma[2] = 0.761200900507; sigma[3] = 0.80771451755; sigma[4] = 0.702871854615; sigma[5] = 0.717942376589; sigma[6] = 0.681628037081; sigma[7] = 0.504494832367; sigma[8] = 0.447564567846; sigma[9] = 0.632764456374; sigma[10] = 1.30597351786; sigma[11] = 2.395390105544; sigma[12] = 2.303942458342; sigma[13] = 2.658485959149; sigma[14] = 2.546495439875; sigma[15] = 2.792097981291; sigma[16] = 2.513210101055; sigma[17] = 2.604114682517; sigma[18] = 3.261294202573; sigma[19] = 4.571877483929; sigma[20] = 7.352492228323; sigma[21] = 9.008243993067; sigma[22] = 8.793456629769; sigma[23] = 10.646880982484; sigma[24] = 11.812573505608; sigma[25] = 12.547609657273; sigma[26] = 10.510262429835; sigma[27] = 8.588996790735; sigma[28] = 5.782418249998; sigma[29] = 5.61088501335; sigma[30] = 6.254641058423; sigma[31] = 8.070186814198;
                        votes[1] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.836468750773; theta[1] = 0.687048409013; theta[2] = 0.410139881911; theta[3] = 0.306026167562; theta[4] = 0.295572726626; theta[5] = 0.188059020282; theta[6] = 0.154677805324; theta[7] = 0.148531088638; theta[8] = 0.094505139304; theta[9] = 0.061706415693; theta[10] = -0.063372684012; theta[11] = 0.058497550946; theta[12] = 0.100847503389; theta[13] = 0.052101103717; theta[14] = 0.045190522919; theta[15] = 0.092339950164; theta[16] = 0.088922317517; theta[17] = 0.111723272531; theta[18] = 0.157395325641; theta[19] = 0.111361452631; theta[20] = 0.249059333146; theta[21] = 0.197680994814; theta[22] = 0.204290143034; theta[23] = 0.296788223421; theta[24] = 0.287315096796; theta[25] = 0.367979066867; theta[26] = 0.490131396224; theta[27] = 0.394810787941; theta[28] = 0.447729765269; theta[29] = 0.441123673908; theta[30] = 0.503005539899; theta[31] = 0.374603872803;
                        sigma[0] = 1.165585707; sigma[1] = 1.515179833747; sigma[2] = 1.114112665523; sigma[3] = 1.220094765423; sigma[4] = 0.996194225629; sigma[5] = 0.790110060526; sigma[6] = 0.698563627868; sigma[7] = 0.496892320546; sigma[8] = 0.431982557776; sigma[9] = 0.668207371342; sigma[10] = 0.421463658421; sigma[11] = 0.631092063515; sigma[12] = 0.560217717566; sigma[13] = 0.564758205603; sigma[14] = 0.461523021883; sigma[15] = 0.632696692524; sigma[16] = 0.674615976038; sigma[17] = 0.557696391655; sigma[18] = 0.739027161858; sigma[19] = 0.917546478118; sigma[20] = 1.592936822887; sigma[21] = 1.515146443589; sigma[22] = 1.122708953072; sigma[23] = 1.361236654894; sigma[24] = 0.871605565048; sigma[25] = 1.011113104075; sigma[26] = 1.244341257767; sigma[27] = 1.200000934024; sigma[28] = 1.353732738376; sigma[29] = 1.403535000083; sigma[30] = 1.716372223572; sigma[31] = 1.689582871403;
                        votes[2] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.271226420601; theta[1] = -0.047558135336; theta[2] = -0.0250313076; theta[3] = -0.017762246303; theta[4] = 0.159789710111; theta[5] = 0.059911116441; theta[6] = 0.160047564903; theta[7] = 0.272531707163; theta[8] = 0.25065284972; theta[9] = 0.305554283222; theta[10] = 0.274714056428; theta[11] = 0.27688704036; theta[12] = 0.279455861489; theta[13] = 0.259929750255; theta[14] = 0.32080979257; theta[15] = 0.336617625774; theta[16] = 0.335871649133; theta[17] = 0.329731315328; theta[18] = 0.378241488204; theta[19] = 0.346042097899; theta[20] = 0.332815991436; theta[21] = 0.359518250802; theta[22] = 0.478158397785; theta[23] = 0.376540932436; theta[24] = 0.387647143846; theta[25] = 0.370051109013; theta[26] = 0.323240328339; theta[27] = 0.320079575103; theta[28] = 0.263237280691; theta[29] = 0.283702550121; theta[30] = 0.296972644801; theta[31] = 0.182516712778;
                        sigma[0] = 0.688071488545; sigma[1] = 0.614419362474; sigma[2] = 0.607666030015; sigma[3] = 0.736196388196; sigma[4] = 0.749522167603; sigma[5] = 0.507231775131; sigma[6] = 0.504405342814; sigma[7] = 0.445006445539; sigma[8] = 0.31578209474; sigma[9] = 0.501223345012; sigma[10] = 0.512093778616; sigma[11] = 0.503432385324; sigma[12] = 0.480915458378; sigma[13] = 0.339073435312; sigma[14] = 0.326166817001; sigma[15] = 0.348387672889; sigma[16] = 0.386387808054; sigma[17] = 0.41891658335; sigma[18] = 0.518516282212; sigma[19] = 0.623061397929; sigma[20] = 0.796257348079; sigma[21] = 0.966792917907; sigma[22] = 2.360819176573; sigma[23] = 1.197431624158; sigma[24] = 1.209428242459; sigma[25] = 1.291438027064; sigma[26] = 1.293639119661; sigma[27] = 1.153562697917; sigma[28] = 1.048183632186; sigma[29] = 1.154237001309; sigma[30] = 1.06799576055; sigma[31] = 0.811247810227;
                        votes[3] = 0.25 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 4; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }