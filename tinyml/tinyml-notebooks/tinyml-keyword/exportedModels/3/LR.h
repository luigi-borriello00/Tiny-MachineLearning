#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -0.445947797554 ,-1.287605797628 ,-0.728729259191  };
                        votes[0] += dot(x,   -0.756857531751  , 0.657254673564  , 0.513303389085  , -0.487499154896  , -0.551370199981  , -0.025949437489  , 0.514984599146  , 0.606543247147  , 0.071566051433  , -0.215754338505  , 0.387824970356  , -0.453377812744  , 0.564650529135  , -0.187055639299  , -0.203043964264  , 0.766232667583  , -0.93862453253  , -0.721366369225  , -1.224174496108  , 0.011918679568  , 0.505252370015  , 0.185240262661  , -0.03849200489  , -0.101787930472  , 0.681169663248  , -1.242341913342  , 0.458246239131  , -0.911397531711  , 0.939524063033  , 0.268632815681  , -0.34077476251  , -0.051851776802 );
                        votes[1] += dot(x,   0.185938966913  , -0.127103938146  , -0.760092605383  , 0.706230573076  , -0.130952359185  , 0.044030481557  , -0.376709966051  , -0.046740027632  , -0.32288077514  , -0.357698737976  , -0.368049674775  , 0.58116798647  , -0.264109097975  , 0.172380979492  , 0.021617293403  , -0.01844577913  , 0.497577729287  , 0.789091548542  , -0.15330411624  , 0.005032817686  , -0.05150206084  , 0.319564718904  , -0.326057147632  , -0.090737081341  , 0.153775182004  , 0.571332493694  , -0.361232049448  , 0.096739985137  , -0.200763651505  , 0.004524630388  , -0.358395703106  , 0.618800747929 );
                        votes[2] += dot(x,   0.52789203299  , -0.496175656869  , 0.109213841558  , -0.159094200991  , 0.760990197551  , -0.056538122518  , -0.274367634492  , -0.54583789369  , 0.173362514545  , 0.561226934127  , -0.016973954325  , -0.068921259397  , -0.274144462175  , -0.167146633177  , 0.020642183017  , -0.210051458236  , 0.243264740349  , -0.269938310074  , 0.350190064393  , -0.065552386148  , -0.141044332219  , -0.31268596732  , 0.384348041367  , -0.064858536382  , -0.562994190598  , 0.564573628247  , -0.267758424459  , 0.660141269167  , -0.504131758983  , -0.189799299243  , 0.843819368148  , -0.751908076643 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }