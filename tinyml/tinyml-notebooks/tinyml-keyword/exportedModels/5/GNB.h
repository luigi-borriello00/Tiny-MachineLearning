#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 0.10266982845; theta[1] = -9.4984053e-05; theta[2] = -0.050920111554; theta[3] = -0.031830782078; theta[4] = 0.070124999851; theta[5] = 0.158685646112; theta[6] = 0.319831222376; theta[7] = 0.487459783169; theta[8] = 0.57047918506; theta[9] = 0.523278894678; theta[10] = 0.458416632169; theta[11] = 0.399485339044; theta[12] = 0.301961847934; theta[13] = 0.196143711495; theta[14] = 0.120912313256; theta[15] = 0.102110935669; theta[16] = 0.047815451304; theta[17] = 0.07342077323; theta[18] = 0.129653467476; theta[19] = 0.220346695691; theta[20] = 0.215723808649; theta[21] = 0.277918804744; theta[22] = 0.300215512665; theta[23] = 0.348347307701; theta[24] = 0.473998965562; theta[25] = 0.500602537084; theta[26] = 0.577136382797; theta[27] = 0.625215593553; theta[28] = 0.666690348758; theta[29] = 0.544819313424; theta[30] = 0.443093051844; theta[31] = 0.260773338397;
                        sigma[0] = 0.307551166017; sigma[1] = 0.264143630244; sigma[2] = 0.245925515786; sigma[3] = 0.209944934103; sigma[4] = 0.240055270672; sigma[5] = 0.287536193027; sigma[6] = 0.385836938101; sigma[7] = 0.369869300273; sigma[8] = 0.467830575532; sigma[9] = 0.639945519557; sigma[10] = 0.754541915012; sigma[11] = 1.002367634826; sigma[12] = 0.848027182821; sigma[13] = 0.743596173995; sigma[14] = 0.429139714614; sigma[15] = 0.475428525574; sigma[16] = 0.414228428709; sigma[17] = 0.438681807458; sigma[18] = 0.914990153724; sigma[19] = 2.284462618247; sigma[20] = 2.883002430441; sigma[21] = 4.154518580711; sigma[22] = 3.617938061332; sigma[23] = 6.074299706548; sigma[24] = 8.67683887006; sigma[25] = 8.772024184829; sigma[26] = 10.526877868716; sigma[27] = 11.460032441642; sigma[28] = 12.306047127155; sigma[29] = 8.522981182572; sigma[30] = 3.955029987043; sigma[31] = 1.582933529211;
                        votes[0] = 0.2 - gauss(x, theta, sigma);
                        theta[0] = 0.08294822478; theta[1] = -0.11729690963; theta[2] = -0.058213709423; theta[3] = -0.086663345175; theta[4] = -0.108074313347; theta[5] = -0.203221152852; theta[6] = -0.143576699779; theta[7] = -0.011429490907; theta[8] = 0.172715511026; theta[9] = 0.344995115853; theta[10] = 0.970664545628; theta[11] = 1.450469554394; theta[12] = 1.776397675968; theta[13] = 2.134955928816; theta[14] = 2.24159805865; theta[15] = 2.439039530768; theta[16] = 2.521993030374; theta[17] = 2.533455588365; theta[18] = 2.720086118582; theta[19] = 2.737419111513; theta[20] = 2.571583731153; theta[21] = 2.529731749478; theta[22] = 2.242674692656; theta[23] = 2.038515759924; theta[24] = 2.118388694932; theta[25] = 1.771752406934; theta[26] = 1.551648945059; theta[27] = 1.2714448163; theta[28] = 0.927904476968; theta[29] = 0.95978881883; theta[30] = 0.932480318784; theta[31] = 1.023117578854;
                        sigma[0] = 0.489517679254; sigma[1] = 0.405070726866; sigma[2] = 0.476352722979; sigma[3] = 0.482926078738; sigma[4] = 0.367338491095; sigma[5] = 0.375373052651; sigma[6] = 0.463148159519; sigma[7] = 0.498654450339; sigma[8] = 0.692050831633; sigma[9] = 0.962896350069; sigma[10] = 1.947871715396; sigma[11] = 3.67189242035; sigma[12] = 3.518503821302; sigma[13] = 4.548844443896; sigma[14] = 3.963683159406; sigma[15] = 4.47488607561; sigma[16] = 4.055683431537; sigma[17] = 4.332483053252; sigma[18] = 5.480508849087; sigma[19] = 7.588309498055; sigma[20] = 9.148302070153; sigma[21] = 11.469078474751; sigma[22] = 10.934813699347; sigma[23] = 11.275470456605; sigma[24] = 14.642301343429; sigma[25] = 15.014982504815; sigma[26] = 13.046680772412; sigma[27] = 9.95044660932; sigma[28] = 6.10064644758; sigma[29] = 5.859447685591; sigma[30] = 6.249804635658; sigma[31] = 9.21514070919;
                        votes[1] = 0.2 - gauss(x, theta, sigma);
                        theta[0] = 0.685495155978; theta[1] = 0.437754492017; theta[2] = 0.221945833839; theta[3] = 0.149848955073; theta[4] = 0.199819798152; theta[5] = 0.20899048683; theta[6] = 0.236531595072; theta[7] = 0.322649676194; theta[8] = 0.348034054781; theta[9] = 0.253526985689; theta[10] = 0.153560569766; theta[11] = 0.28510579814; theta[12] = 0.254356084718; theta[13] = 0.173806581701; theta[14] = 0.161488883628; theta[15] = 0.155267917287; theta[16] = 0.139017263276; theta[17] = 0.120683784357; theta[18] = 0.141943621748; theta[19] = 0.106973679086; theta[20] = 0.188016036763; theta[21] = 0.138026855888; theta[22] = 0.18778169619; theta[23] = 0.252285594593; theta[24] = 0.318350142954; theta[25] = 0.396313361362; theta[26] = 0.514226547242; theta[27] = 0.432230331966; theta[28] = 0.459047743097; theta[29] = 0.4627805747; theta[30] = 0.483260213836; theta[31] = 0.408383466975;
                        sigma[0] = 0.845211725877; sigma[1] = 0.960728523235; sigma[2] = 0.729323533981; sigma[3] = 0.806399835673; sigma[4] = 0.712272494757; sigma[5] = 0.567285508908; sigma[6] = 0.658985738686; sigma[7] = 0.636542531338; sigma[8] = 0.655982685465; sigma[9] = 1.006486549033; sigma[10] = 0.770164062452; sigma[11] = 1.130768589217; sigma[12] = 0.859506215437; sigma[13] = 0.883791542958; sigma[14] = 0.549975748862; sigma[15] = 0.663573967575; sigma[16] = 0.621285028773; sigma[17] = 0.48489278988; sigma[18] = 0.631447089432; sigma[19] = 0.585801337215; sigma[20] = 0.817428873428; sigma[21] = 0.814082363003; sigma[22] = 0.624237821224; sigma[23] = 0.830584018945; sigma[24] = 0.895232328183; sigma[25] = 1.036490114169; sigma[26] = 1.280095403569; sigma[27] = 1.237698720976; sigma[28] = 1.31173955991; sigma[29] = 1.436997792597; sigma[30] = 1.526050960415; sigma[31] = 1.71657778658;
                        votes[2] = 0.2 - gauss(x, theta, sigma);
                        theta[0] = 0.542205905045; theta[1] = 0.454917270812; theta[2] = 0.356369052177; theta[3] = 0.147497764485; theta[4] = 0.163435976537; theta[5] = 0.113815103766; theta[6] = 0.00352958063; theta[7] = -0.111010154853; theta[8] = -0.125438706421; theta[9] = -0.145295069576; theta[10] = -0.09320740441; theta[11] = -0.028776511921; theta[12] = 0.109290040942; theta[13] = 0.067220130817; theta[14] = 0.094091221761; theta[15] = 0.075327870805; theta[16] = 0.139164341987; theta[17] = 0.128751474829; theta[18] = 0.188942553115; theta[19] = 0.174533629318; theta[20] = 0.2630937153; theta[21] = 0.400384627244; theta[22] = 0.470109078555; theta[23] = 0.618367309221; theta[24] = 0.698167344319; theta[25] = 0.718713364167; theta[26] = 0.792402780584; theta[27] = 0.727393929241; theta[28] = 0.767364893667; theta[29] = 0.785184189517; theta[30] = 0.813590375421; theta[31] = 0.707241110449;
                        sigma[0] = 0.662272463494; sigma[1] = 0.878071305853; sigma[2] = 0.974244312993; sigma[3] = 0.880471729212; sigma[4] = 0.744454363694; sigma[5] = 0.719225814162; sigma[6] = 0.555865011132; sigma[7] = 0.185560764413; sigma[8] = 0.204359498742; sigma[9] = 0.326843901854; sigma[10] = 0.50770060245; sigma[11] = 0.848406312906; sigma[12] = 1.331623213609; sigma[13] = 1.107713840203; sigma[14] = 0.860310252251; sigma[15] = 0.721081390267; sigma[16] = 0.84125635308; sigma[17] = 1.144095451683; sigma[18] = 1.481970999592; sigma[19] = 2.26410929891; sigma[20] = 2.767078129536; sigma[21] = 4.224985617028; sigma[22] = 4.766377768359; sigma[23] = 5.211298107359; sigma[24] = 6.619294889531; sigma[25] = 5.910682382206; sigma[26] = 6.099219423758; sigma[27] = 5.749232864966; sigma[28] = 5.821731615258; sigma[29] = 5.423114984274; sigma[30] = 5.227146520562; sigma[31] = 4.73124980326;
                        votes[3] = 0.2 - gauss(x, theta, sigma);
                        theta[0] = 0.233568820327; theta[1] = -0.105218964037; theta[2] = -0.068706314194; theta[3] = -0.028602064915; theta[4] = 0.099680379095; theta[5] = 0.080959643407; theta[6] = 0.182424953351; theta[7] = 0.349905898413; theta[8] = 0.367932109451; theta[9] = 0.375078983398; theta[10] = 0.373899904956; theta[11] = 0.388787937908; theta[12] = 0.341295672052; theta[13] = 0.393969727303; theta[14] = 0.443870950772; theta[15] = 0.453328308327; theta[16] = 0.455047355627; theta[17] = 0.414727239245; theta[18] = 0.515807690206; theta[19] = 0.477671668754; theta[20] = 0.352585886962; theta[21] = 0.392223655165; theta[22] = 0.486029316671; theta[23] = 0.34001094539; theta[24] = 0.360562763099; theta[25] = 0.316778466225; theta[26] = 0.228758390015; theta[27] = 0.235952945715; theta[28] = 0.185830083624; theta[29] = 0.172649499541; theta[30] = 0.202251719765; theta[31] = 0.161884909846;
                        sigma[0] = 0.518206019854; sigma[1] = 0.422260462686; sigma[2] = 0.501437935955; sigma[3] = 0.562414647049; sigma[4] = 0.523408450721; sigma[5] = 0.402986149675; sigma[6] = 0.486662204379; sigma[7] = 0.488516961454; sigma[8] = 0.38742427958; sigma[9] = 0.521864602093; sigma[10] = 0.541545565141; sigma[11] = 0.675189003059; sigma[12] = 0.518322828308; sigma[13] = 0.531286290287; sigma[14] = 0.500698831155; sigma[15] = 0.561839325455; sigma[16] = 0.600007958792; sigma[17] = 0.63330921336; sigma[18] = 0.897208966514; sigma[19] = 0.995776903105; sigma[20] = 0.967491181823; sigma[21] = 1.230947607876; sigma[22] = 2.807333831243; sigma[23] = 1.172701514218; sigma[24] = 1.258932208551; sigma[25] = 1.184113072627; sigma[26] = 0.958916970242; sigma[27] = 0.941257397267; sigma[28] = 0.908800093308; sigma[29] = 0.972959491715; sigma[30] = 0.915801506291; sigma[31] = 0.857775288915;
                        votes[4] = 0.2 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }