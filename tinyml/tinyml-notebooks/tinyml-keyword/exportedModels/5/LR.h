#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -0.445909065961 ,-1.287605798186 ,-0.728729267533  };
                        votes[0] += dot(x,   -0.756870907524  , 0.657323446245  , 0.513171063504  , -0.487623460192  , -0.550895622249  , -0.025779638707  , 0.514486871572  , 0.606645767585  , 0.071335986699  , -0.215756843264  , 0.387920639117  , -0.453237479962  , 0.564926378721  , -0.18761995397  , -0.203110360258  , 0.766902382426  , -0.938868679991  , -0.721114833819  , -1.225161582964  , 0.012088977297  , 0.505687871343  , 0.18509005664  , -0.038460486419  , -0.101960259693  , 0.681383878606  , -1.242225874935  , 0.458130597697  , -0.911261366481  , 0.939577357534  , 0.268425257632  , -0.341153227862  , -0.051430711721 );
                        votes[1] += dot(x,   0.18593896585  , -0.127103937995  , -0.760092605725  , 0.706230571698  , -0.130952359035  , 0.044030481782  , -0.376709965383  , -0.046740027731  , -0.322880776909  , -0.357698738372  , -0.368049674401  , 0.581167985336  , -0.264109099793  , 0.172380978645  , 0.02161729443  , -0.018445779971  , 0.497577727329  , 0.789091548582  , -0.153304117172  , 0.005032814653  , -0.05150206573  , 0.319564714773  , -0.326057149539  , -0.09073708515  , 0.153775181622  , 0.571332486162  , -0.361232055403  , 0.09673998292  , -0.200763658333  , 0.004524623611  , -0.358395702138  , 0.618800745057 );
                        votes[2] += dot(x,   0.527892026878  , -0.496175669595  , 0.109213810066  , -0.159094200332  , 0.760990198799  , -0.056538127614  , -0.274367651377  , -0.545837903976  , 0.173362516289  , 0.561226924989  , -0.016973945079  , -0.068921273281  , -0.27414448502  , -0.16714666291  , 0.020642173075  , -0.210051469402  , 0.243264700222  , -0.269938322385  , 0.350190012899  , -0.065552419631  , -0.141044378146  , -0.31268600381  , 0.384348007155  , -0.064858586709  , -0.562994255964  , 0.564573589323  , -0.26775849213  , 0.660141182521  , -0.50413180444  , -0.189799342262  , 0.843819319207  , -0.751908093563 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }