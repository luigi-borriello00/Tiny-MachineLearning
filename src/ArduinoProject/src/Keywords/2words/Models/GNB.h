#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[2] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 1557.9635; theta[1] = 1758.5665; theta[2] = 1727.378; theta[3] = 1662.34725; theta[4] = 1541.065166666668; theta[5] = 1492.829666666667; theta[6] = 1449.554333333333; theta[7] = 1371.903666666666; theta[8] = 1242.692583333333; theta[9] = 1040.868583333334; theta[10] = 902.599166666667; theta[11] = 745.467166666667; theta[12] = 648.5085; theta[13] = 548.756; theta[14] = 467.642; theta[15] = 392.813166666667; theta[16] = 332.3325; theta[17] = 296.880583333333; theta[18] = 264.840583333333; theta[19] = 260.01025; theta[20] = 236.86175; theta[21] = 229.230416666667; theta[22] = 227.521083333333; theta[23] = 216.81925; theta[24] = 216.22325; theta[25] = 205.320166666667; theta[26] = 206.086916666667; theta[27] = 205.085083333333; theta[28] = 211.830916666667; theta[29] = 207.625416666667; theta[30] = 203.15625; theta[31] = 211.313416666667;
                        sigma[0] = 423920.12970200495; sigma[1] = 463752.49396200525; sigma[2] = 405796.59622192185; sigma[3] = 405617.28788752586; sigma[4] = 596880.6570708938; sigma[5] = 553466.4726858106; sigma[6] = 607712.3932104777; sigma[7] = 717334.9146974772; sigma[8] = 630122.9467800811; sigma[9] = 534727.3351880816; sigma[10] = 563557.4471852274; sigma[11] = 490209.7262328942; sigma[12] = 457305.40878700494; sigma[13] = 345017.66027492145; sigma[14] = 257737.5987035884; sigma[15] = 194582.42295422722; sigma[16] = 141062.1767446718; sigma[17] = 95617.77710641487; sigma[18] = 80302.5095630815; sigma[19] = 70921.50099335928; sigma[20] = 62556.868465359315; sigma[21] = 59141.76674824816; sigma[22] = 64674.22947891485; sigma[23] = 65537.98241952594; sigma[24] = 70819.12132119255; sigma[25] = 72350.8723325607; sigma[26] = 70750.74980724815; sigma[27] = 64378.21821424819; sigma[28] = 60161.2455825815; sigma[29] = 56114.38644908151; sigma[30] = 52683.817332692626; sigma[31] = 47040.714538414846;
                        votes[0] = 0.5 - gauss(x, theta, sigma);
                        theta[0] = 1798.990666666667; theta[1] = 1817.29725; theta[2] = 1831.448666666667; theta[3] = 1837.788583333334; theta[4] = 1726.923166666666; theta[5] = 1476.182249999999; theta[6] = 1323.23525; theta[7] = 1209.2795; theta[8] = 1119.592166666667; theta[9] = 991.98575; theta[10] = 862.713416666667; theta[11] = 749.417083333333; theta[12] = 676.341083333334; theta[13] = 617.003583333333; theta[14] = 592.891; theta[15] = 549.095166666666; theta[16] = 524.40475; theta[17] = 480.2445; theta[18] = 458.27; theta[19] = 415.950666666667; theta[20] = 359.23175; theta[21] = 324.714083333333; theta[22] = 291.239916666667; theta[23] = 278.672083333333; theta[24] = 259.53375; theta[25] = 253.346416666667; theta[26] = 238.264166666667; theta[27] = 239.297416666667; theta[28] = 225.249083333333; theta[29] = 220.217916666667; theta[30] = 215.329; theta[31] = 209.59825;
                        sigma[0] = 845628.2581838107; sigma[1] = 832966.3891158588; sigma[2] = 1025835.619815811; sigma[3] = 1470216.7234814148; sigma[4] = 1486769.5286292266; sigma[5] = 1032749.462235026; sigma[6] = 829296.1736941924; sigma[7] = 805470.1242890052; sigma[8] = 624177.7562145606; sigma[9] = 484041.33991035953; sigma[10] = 388663.34664174815; sigma[11] = 295017.77121324814; sigma[12] = 296895.3313372482; sigma[13] = 205491.0745972481; sigma[14] = 198894.5611199217; sigma[15] = 184423.66222756074; sigma[16] = 158446.92197752596; sigma[17] = 165488.56122900508; sigma[18] = 156488.70613258844; sigma[19] = 129765.6100288106; sigma[20] = 109742.31730535928; sigma[21] = 90712.36502674817; sigma[22] = 77383.4213034148; sigma[23] = 73490.2358557482; sigma[24] = 58952.04191769262; sigma[25] = 56303.88739891481; sigma[26] = 63539.83180522737; sigma[27] = 52194.22400508149; sigma[28] = 45721.75919091484; sigma[29] = 47784.26635408151; sigma[30] = 40861.06674992176; sigma[31] = 32554.205868692603;
                        votes[1] = 0.5 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 2; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }