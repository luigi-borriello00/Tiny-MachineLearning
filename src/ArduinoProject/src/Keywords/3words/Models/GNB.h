#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 1557.963500000001; theta[1] = 1758.5665; theta[2] = 1727.378; theta[3] = 1662.34725; theta[4] = 1541.065166666668; theta[5] = 1492.829666666667; theta[6] = 1449.554333333334; theta[7] = 1371.903666666666; theta[8] = 1242.692583333333; theta[9] = 1040.868583333333; theta[10] = 902.599166666667; theta[11] = 745.467166666667; theta[12] = 648.5085; theta[13] = 548.756; theta[14] = 467.642; theta[15] = 392.813166666667; theta[16] = 332.3325; theta[17] = 296.880583333333; theta[18] = 264.840583333333; theta[19] = 260.01025; theta[20] = 236.86175; theta[21] = 229.230416666667; theta[22] = 227.521083333333; theta[23] = 216.81925; theta[24] = 216.22325; theta[25] = 205.320166666667; theta[26] = 206.086916666667; theta[27] = 205.085083333334; theta[28] = 211.830916666667; theta[29] = 207.625416666667; theta[30] = 203.15625; theta[31] = 211.313416666667;
                        sigma[0] = 423920.1295766879; sigma[1] = 463752.49383668764; sigma[2] = 405796.5960966045; sigma[3] = 405617.28776220867; sigma[4] = 596880.6569455765; sigma[5] = 553466.4725604935; sigma[6] = 607712.39308516; sigma[7] = 717334.9145721603; sigma[8] = 630122.946654764; sigma[9] = 534727.3350627641; sigma[10] = 563557.44705991; sigma[11] = 490209.72610757663; sigma[12] = 457305.4086616876; sigma[13] = 345017.6601496043; sigma[14] = 257737.598578271; sigma[15] = 194582.42282891012; sigma[16] = 141062.17661935437; sigma[17] = 95617.77698109743; sigma[18] = 80302.50943776415; sigma[19] = 70921.5008680419; sigma[20] = 62556.8683400419; sigma[21] = 59141.76662293077; sigma[22] = 64674.22935359746; sigma[23] = 65537.98229420857; sigma[24] = 70819.12119587521; sigma[25] = 72350.87220724324; sigma[26] = 70750.74968193073; sigma[27] = 64378.21808893079; sigma[28] = 60161.245457264115; sigma[29] = 56114.386323764105; sigma[30] = 52683.81720737522; sigma[31] = 47040.71441309744;
                        votes[0] = 0.333333333333 - gauss(x, theta, sigma);
                        theta[0] = 1552.775416666666; theta[1] = 1713.321166666667; theta[2] = 1730.523916666668; theta[3] = 1643.514250000001; theta[4] = 1380.409166666666; theta[5] = 1113.30175; theta[6] = 908.441083333334; theta[7] = 798.804666666667; theta[8] = 772.82225; theta[9] = 788.102583333334; theta[10] = 981.567166666666; theta[11] = 1064.248416666667; theta[12] = 1181.899833333333; theta[13] = 1274.09575; theta[14] = 1302.098666666667; theta[15] = 1269.895666666666; theta[16] = 1282.560916666666; theta[17] = 1181.11; theta[18] = 1079.042333333334; theta[19] = 975.359916666667; theta[20] = 856.208833333333; theta[21] = 719.079583333334; theta[22] = 607.905833333333; theta[23] = 539.445583333334; theta[24] = 455.372333333333; theta[25] = 414.987083333333; theta[26] = 383.301416666667; theta[27] = 364.470666666667; theta[28] = 330.761083333334; theta[29] = 330.09675; theta[30] = 323.510166666667; theta[31] = 320.726916666667;
                        sigma[0] = 495645.0849370974; sigma[1] = 458167.30798424326; sigma[2] = 825219.8558544309; sigma[3] = 1062190.7703583757; sigma[4] = 854114.9867865767; sigma[5] = 756490.7881833756; sigma[6] = 522188.9081552641; sigma[7] = 496011.5151621598; sigma[8] = 497241.06825137517; sigma[9] = 500761.799939764; sigma[10] = 910612.0870559099; sigma[11] = 1143219.483782264; sigma[12] = 1304263.42488891; sigma[13] = 1403288.634595042; sigma[14] = 1269286.4029754936; sigma[15] = 1235646.6197218266; sigma[16] = 1293968.4551355976; sigma[17] = 1097305.5450022712; sigma[18] = 1043660.0741434935; sigma[19] = 886088.4479480973; sigma[20] = 763629.0406575769; sigma[21] = 589089.8881995971; sigma[22] = 425711.45674824325; sigma[23] = 340097.7843502638; sigma[24] = 259686.50076349327; sigma[25] = 265462.80513293087; sigma[26] = 305808.2117527641; sigma[27] = 255716.3567834932; sigma[28] = 173010.08453693075; sigma[29] = 157840.48205420858; sigma[30] = 156079.88899890997; sigma[31] = 141052.82437026416;
                        votes[1] = 0.333333333333 - gauss(x, theta, sigma);
                        theta[0] = 1878.37425; theta[1] = 1873.194333333333; theta[2] = 1890.690833333334; theta[3] = 1866.42525; theta[4] = 1774.342; theta[5] = 1564.219750000001; theta[6] = 1368.636333333333; theta[7] = 1217.812083333334; theta[8] = 1143.0675; theta[9] = 997.265583333334; theta[10] = 874.448833333334; theta[11] = 747.984833333333; theta[12] = 679.444333333334; theta[13] = 636.988; theta[14] = 603.615; theta[15] = 556.91275; theta[16] = 539.098333333333; theta[17] = 490.67975; theta[18] = 458.384083333333; theta[19] = 411.815083333334; theta[20] = 356.270666666666; theta[21] = 320.132416666667; theta[22] = 311.17825; theta[23] = 270.9765; theta[24] = 253.478333333333; theta[25] = 253.976583333334; theta[26] = 237.111333333333; theta[27] = 240.6815; theta[28] = 225.455583333333; theta[29] = 220.75175; theta[30] = 216.833416666667; theta[31] = 211.692416666667;
                        sigma[0] = 1012603.8909617083; sigma[1] = 947198.70938516; sigma[2] = 1126004.4397032433; sigma[3] = 1393388.675682208; sigma[4] = 1433940.4528149387; sigma[5] = 1034062.2393847086; sigma[6] = 789976.8674504934; sigma[7] = 642436.9668070974; sigma[8] = 545587.1538793544; sigma[9] = 405918.6133235973; sigma[10] = 325332.70012924337; sigma[11] = 263828.8688755766; sigma[12] = 251423.8580234932; sigma[13] = 205108.54790327098; sigma[14] = 193371.76502893778; sigma[15] = 179932.39198387522; sigma[16] = 161821.93587615993; sigma[17] = 163238.47592970863; sigma[18] = 155143.03860309755; sigma[19] = 123515.24446226403; sigma[20] = 111587.48458682655; sigma[21] = 91851.95319893079; sigma[22] = 159856.86130504182; sigma[23] = 76367.97874835438; sigma[24] = 62574.056826159955; sigma[25] = 67428.79674476413; sigma[26] = 67399.8909638266; sigma[27] = 56073.07532002103; sigma[28] = 48736.17646693079; sigma[29] = 48645.994970041895; sigma[30] = 42934.305821430775; sigma[31] = 33326.157242264126;
                        votes[2] = 0.333333333333 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }