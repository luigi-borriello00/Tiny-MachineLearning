#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { -0.207058679799 ,0.695022488146 ,1.305930444877 ,0.204880975033 ,-1.998775228257  };
                        votes[0] += dot(x,   0.866810436439  , 0.0869092746  , 0.202819727714  , 0.660442989853  , 0.146495640093  , 0.297084241885  , 0.716009610312  , 0.138083669588  , -0.270242723481  , 0.628031335478  , 0.218304035742  , 0.162488969418  , 0.884216572716  , 0.044856633645  , 0.295908991822  , 0.922589286651  , -0.043707640579  , 0.206544961542  , 1.012245271615  , 0.058863698403  , -0.019244832014  , 0.843935239531  , -0.094078743799  , -0.096692590509  , 0.900632089674  , 0.047479695315  , 0.005061195364  , 0.825716989316  , -0.221351562889  , -0.091030672033  , 0.937322891029  , -0.175444730604  , 0.104682508855  , 0.614023218627  , -0.013232796145  , -0.102527401361  , 0.685017734304  , -0.251468006623  , -0.163565156802  , 0.943700504684  , 0.089783398162  , -0.119308668265  , 0.781538030903  , 0.226268752257  , 0.093115769089  , 0.869009647633  , -0.192783234374  , -0.125512222191  , 0.684019960549  , -0.248659405445  , 0.170670126413  , 0.127643272162  , -0.17446477878  , 0.180937440081  , 0.457070248128  , 0.00771328367  , 0.131739092886  , 1.036184582395  , -0.081059046637  , 0.280161912919 );
                        votes[1] += dot(x,   1.563288300127  , 0.270810917274  , 0.564639099665  , 1.195580385546  , 0.036649798984  , 0.544278648661  , 1.010639981204  , -0.064442690388  , -0.195804426922  , 1.234105795653  , 0.219299088856  , 0.495020963802  , 1.359720805416  , 0.131117240548  , 0.526694690724  , 1.133204787259  , -0.063321034096  , 0.370177084062  , 1.358919313956  , -0.35144997973  , 0.094844198316  , 1.930579195857  , -0.321053983691  , -0.236114780383  , 1.821997444193  , -0.578195662993  , -0.4559061045  , 1.989456713695  , -0.210668196426  , -0.236250061174  , 1.643460087535  , -0.507266949036  , -0.372257226173  , 2.228344982419  , -0.597864605298  , -0.230024775515  , 1.978426002345  , -0.152200918574  , -0.155251359293  , 1.849561133379  , -0.285500871894  , -0.216847339928  , 1.865810694875  , -0.27008553556  , -0.334382148738  , 1.701834183229  , -0.037802013732  , -0.124737019989  , 1.226636844363  , -0.707857377867  , -0.174939158106  , 1.019790405643  , -0.289051268525  , 0.344021454951  , 0.925709983777  , -0.283373291943  , 0.190607451763  , 1.470327315482  , -0.516982566033  , 0.260739169067 );
                        votes[2] += dot(x,   0.720065759673  , 3.539522628634  , -0.335556766512  , 0.563236369037  , 2.627810718397  , -0.375507263962  , 0.821327427453  , 2.368284697078  , -0.175417319242  , 0.688548229646  , 2.637100291034  , -0.553922211077  , 0.784552025325  , 3.191920627325  , -0.199751975586  , 1.180854865103  , 3.370616561841  , -0.133915976712  , 1.147828608631  , 3.898863226505  , -0.265500900549  , 1.130480950942  , 4.911753415844  , -0.397684612392  , 1.13828837713  , 5.346024013208  , -0.242649590284  , 0.949607560903  , 5.02866743068  , -0.342700297079  , 0.914260421562  , 4.807323163415  , -0.150771668636  , 0.685966924974  , 5.667011916288  , -0.121496612131  , 0.850937172277  , 4.891024560991  , -0.447877867875  , 1.075518848077  , 4.295742706799  , -0.205992090106  , 1.36085395958  , 3.231962290844  , 0.024422668652  , 1.294920074461  , 3.162266607959  , 0.631283774124  , 1.153745408858  , 2.953620342758  , 0.395672483631  , 0.998117227841  , 2.587312778683  , -0.160659797938  , 1.422296850805  , 2.755665173938  , 0.418565359329  , 1.400553426036  , 3.518001108443  , 0.055893065316 );
                        votes[3] += dot(x,   -1.40766656103  , -1.674381904372  , -0.341180902908  , -0.833318709946  , -1.2561261654  , -0.128981153751  , -1.086458532467  , -0.908403270367  , 0.256995371285  , -0.860491111299  , -1.414718641478  , -0.13226089722  , -1.192761701231  , -1.5220526704  , -0.27439924161  , -1.2952735407  , -1.394109150918  , -0.093883646392  , -1.473418935875  , -1.535900091908  , 0.19569376002  , -1.593613082713  , -1.975795642104  , 0.386763220526  , -1.579638269828  , -2.118447590522  , 0.161708976815  , -1.503424545774  , -2.179056953783  , 0.328139471405  , -1.622832216236  , -1.741140949685  , 0.002401547093  , -1.538695556413  , -2.093066691848  , 0.077967404064  , -1.396475377432  , -1.979426422097  , 0.133980859478  , -1.678705981312  , -1.915356820105  , 0.175364741693  , -1.821490515019  , -1.521291924082  , -0.118083430865  , -1.554371421836  , -1.197218823794  , -0.234210691255  , -1.409436225301  , -0.676179907441  , -0.275767995109  , -1.006633669563  , -1.040237779557  , -0.177863923637  , -1.064397274791  , -1.05326166478  , -0.265382538625  , -1.784285209077  , -1.280844412163  , -0.212866805133 );
                        votes[4] += dot(x,   -1.742497935209  , -2.222860916136  , -0.090721157958  , -1.585941034489  , -1.554829992075  , -0.336874472833  , -1.461518486502  , -1.53352240591  , 0.38446909836  , -1.690194249478  , -1.659984774155  , 0.028673175077  , -1.835727702226  , -1.845841831118  , -0.34845246535  , -1.941375398313  , -1.869478736249  , -0.348922422501  , -2.045574258328  , -2.070376853271  , -0.005792225773  , -2.311382303617  , -2.520825046251  , 0.343728762758  , -2.281279641168  , -2.696860455008  , 0.531785522605  , -2.26135671814  , -2.417590717581  , 0.341841558881  , -1.87221118389  , -2.383470534089  , 0.415944838861  , -1.989639569607  , -2.962847822996  , 0.376081384943  , -2.117905531494  , -2.507929213697  , 0.632713524492  , -2.190074504828  , -2.184668412963  , 0.366783356606  , -2.186712170339  , -1.66685358346  , 0.334927141861  , -2.311392483487  , -1.734462536059  , -0.14682384069  , -1.654965988469  , -1.320923652005  , -0.115635456829  , -1.138917236083  , -1.083558951821  , -0.186435173457  , -1.74067980792  , -1.426743500885  , -0.475529365353  , -2.122780114837  , -1.639115083609  , -0.383927342169 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }