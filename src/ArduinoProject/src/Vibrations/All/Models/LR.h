#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[6] = { 1.158336863833 ,-0.02915113862 ,-0.753809332194 ,0.172586664424 ,-0.72730118195 ,0.179338124507  };
                        votes[0] += dot(x,   -0.211444676507  , 3.010090072433  , -0.083334981498  , -0.246229340708  , 2.980668214093  , -0.111620606996  , -0.171662097243  , 2.912056046075  , -0.068096139272  , -0.241759316443  , 2.947661722835  , -0.132018471317  , -0.154146426651  , 2.977848033673  , -0.030837663821  , -0.221409431569  , 2.913941025381  , -0.046504184893  , -0.242022112203  , 3.096599583577  , -0.057497496492  , -0.301809340245  , 3.002197483148  , -0.102095113883  , -0.28476701435  , 2.996411973315  , -0.082386679499  , -0.160879471107  , 3.062201550486  , 0.021328286882  , -0.254171995608  , 2.983620777644  , -0.026344854396  , -0.22217965045  , 2.96846894015  , -0.036053246359  , -0.277940323242  , 2.962811637022  , -0.005245125662  , -0.259004279208  , 3.142354715675  , -0.00934848041  , -0.28288004077  , 2.957040305955  , 0.003782115057  , -0.315424053421  , 3.069420734871  , 0.023020407528  , -0.221701938835  , 2.923343349289  , 0.044666760679  , -0.193637915971  , 2.937139750765  , 0.04894810745  , -0.211118544022  , 2.901589661569  , 0.100104986327  , -0.276011971001  , 3.009189715821  , 0.062476743623 );
                        votes[1] += dot(x,   -5.661578386267  , -3.436163676232  , -0.334410982759  , -5.639229760648  , -3.493772977574  , -0.353276943081  , -5.617387703455  , -3.546185176798  , -0.383970729595  , -5.60675018433  , -3.552038362824  , -0.322578279312  , -5.530901306414  , -3.598951458012  , -0.325162643492  , -5.585600865875  , -3.463746981034  , -0.271186240761  , -5.554126804546  , -3.522368845379  , -0.264292002891  , -5.607794660735  , -3.470721114983  , -0.253514995167  , -5.646599795309  , -3.535513921807  , -0.310443793441  , -5.631156224494  , -3.49393128512  , -0.294483236403  , -5.563174732418  , -3.596046864127  , -0.298987446683  , -5.5237652293  , -3.497453062261  , -0.211550564477  , -5.540694366098  , -3.428171966343  , -0.182389239069  , -5.546668569661  , -3.31467376195  , -0.144592936792  , -5.586567618581  , -3.407278730361  , -0.15263833611  , -5.569996729405  , -3.41681219364  , -0.157579157112  , -5.537156680629  , -3.566017550264  , -0.235710699658  , -5.611876858114  , -3.53976266105  , -0.202513134213  , -5.58276116051  , -3.619205863733  , -0.26843151148  , -5.61119731756  , -3.636152697934  , -0.350691695845 );
                        votes[2] += dot(x,   0.482133631832  , -4.522741875431  , 0.185248448265  , 0.370754010625  , -4.340402379581  , 0.214233604574  , 0.43931872766  , -4.346690600583  , 0.250733141435  , 0.335331608998  , -4.132129284752  , 0.174423037092  , 0.342787948099  , -4.119188273598  , 0.186691238568  , 0.467524216261  , -4.480820566448  , 0.028934450391  , 0.408236677474  , -4.160881135119  , 0.156893624747  , 0.470738498191  , -4.319648125965  , 0.105764978681  , 0.480744316202  , -4.388552114728  , 0.15277127066  , 0.410895884119  , -4.390446620409  , 0.10706318711  , 0.510373470559  , -4.274439397907  , 0.137578214873  , 0.472118364297  , -4.344581523317  , 0.040503434925  , 0.437643424863  , -4.477573549706  , 0.034869248142  , 0.466300164442  , -4.375650416363  , 0.035283081439  , 0.35644851501  , -4.445259381805  , 0.042628989661  , 0.355329597684  , -4.293536905389  , 0.087595748329  , 0.416940858289  , -3.985097019082  , 0.14631310666  , 0.506303395103  , -4.291685018193  , 0.040419722653  , 0.465197482051  , -4.323353321009  , 0.039085203776  , 0.666237213956  , -4.459773561077  , 0.038060259348 );
                        votes[3] += dot(x,   2.294014393837  , 5.378683801479  , 0.006902199453  , 2.330536106039  , 5.432700636528  , 0.023086205834  , 2.307481661191  , 5.460130171431  , -0.018038562677  , 2.274319330073  , 5.451415344134  , 0.06076824162  , 2.261507173932  , 5.488983834524  , -0.027627344278  , 2.294715425258  , 5.477380032509  , -0.03020791786  , 2.298920264329  , 5.421469499249  , 0.029190471784  , 2.329706194588  , 5.463079990628  , 0.048283000729  , 2.256531563587  , 5.410069768197  , 0.018099265721  , 2.18540209028  , 5.367867054887  , -0.085396424542  , 2.28729430745  , 5.455014827482  , -0.048387006534  , 2.288747578838  , 5.480864836305  , -0.033843855896  , 2.283569730979  , 5.474054104629  , -0.080914962142  , 2.282641813589  , 5.430680644664  , -0.050922111331  , 2.280318236645  , 5.441478320522  , -0.096870928631  , 2.292838437345  , 5.443656804575  , -0.083018478547  , 2.246257138955  , 5.478888857599  , -0.137383621739  , 2.211914055581  , 5.446045267869  , -0.137378046968  , 2.218986568498  , 5.490528793854  , -0.186089353868  , 2.197523404537  , 5.473068922047  , -0.155712135685 );
                        votes[4] += dot(x,   -1.335915001097  , 0.271284976526  , 0.100425958174  , -1.276506187144  , 0.086378947463  , 0.009435002367  , -1.394466335457  , 0.220464708205  , 0.085570015776  , -1.244436065889  , -0.069649039554  , 0.01864913265  , -1.380497944919  , -0.072195620471  , 0.009055480884  , -1.382062444919  , 0.226880120445  , 0.12668200181  , -1.362315208005  , -0.155583813981  , -0.028588236808  , -1.30251139986  , 0.005391982681  , 0.016679853235  , -1.254367163679  , 0.208815857391  , 0.083390342421  , -1.211776591519  , 0.121151131361  , 0.042781173948  , -1.410686019233  , 0.121726283143  , 0.07260759261  , -1.450657723292  , 0.066499536243  , 0.079798665488  , -1.336150460548  , 0.163866753661  , 0.061066859428  , -1.337246947323  , -0.21368713156  , 0.018985233542  , -1.198444744112  , 0.149958397074  , 0.064575372073  , -1.2767984352  , -0.129037108558  , -0.032150846904  , -1.367944675137  , -0.184229004927  , -0.008922250794  , -1.299951702906  , 0.135614562292  , 0.111264066298  , -1.364494220927  , 0.195261509218  , 0.154881053972  , -1.450052744711  , 0.244270134081  , 0.238352138668 );
                        votes[5] += dot(x,   4.432790038202  , -0.701153298776  , 0.125169358364  , 4.460675171836  , -0.665572440929  , 0.218142737303  , 4.436715747305  , -0.699775148329  , 0.133802274333  , 4.483294627591  , -0.645260379839  , 0.200756339266  , 4.461250555952  , -0.676496516115  , 0.187880932138  , 4.426833100844  , -0.673633630852  , 0.192281891314  , 4.451307182951  , -0.679235288348  , 0.164293639659  , 4.411670708062  , -0.680300215509  , 0.184882276405  , 4.448458093548  , -0.691231562367  , 0.138569594138  , 4.407514312722  , -0.666841831204  , 0.208707013005  , 4.430364969251  , -0.689875626234  , 0.163533500131  , 4.435736659906  , -0.673798727118  , 0.161145566318  , 4.433571994046  , -0.694986979262  , 0.172613219302  , 4.393977818162  , -0.669024050466  , 0.150595213551  , 4.431125651807  , -0.695938911385  , 0.13852278795  , 4.514051182997  , -0.673691331858  , 0.162132326705  , 4.463605297356  , -0.666888632614  , 0.191036704852  , 4.387249026308  , -0.687351901683  , 0.13925928478  , 4.474189874911  , -0.644820779898  , 0.160449621274  , 4.47350141478  , -0.630602512938  , 0.167514689891 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 6; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }