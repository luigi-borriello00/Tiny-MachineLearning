#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[4] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 0.065335697405; theta[1] = -0.006841565925; theta[2] = -0.012804389977; theta[3] = -0.020563937252; theta[4] = 0.058822144026; theta[5] = 0.103299301783; theta[6] = 0.231794606077; theta[7] = 0.347999696947; theta[8] = 0.381382781956; theta[9] = 0.357976467046; theta[10] = 0.387195192863; theta[11] = 0.336994775489; theta[12] = 0.282429063077; theta[13] = 0.21511731289; theta[14] = 0.169816998495; theta[15] = 0.101604103026; theta[16] = 0.043224000875; theta[17] = 0.030329739666; theta[18] = 0.011964684321; theta[19] = 0.006470025736; theta[20] = -0.002293265616; theta[21] = 0.043486526973; theta[22] = 0.116981253479; theta[23] = 0.112074334971; theta[24] = 0.160861484316; theta[25] = 0.156724074876; theta[26] = 0.240174499077; theta[27] = 0.224276074759; theta[28] = 0.247340236595; theta[29] = 0.253087005141; theta[30] = 0.240299984683; theta[31] = 0.217862621508;
                        sigma[0] = 0.403440148323; sigma[1] = 0.44382129443; sigma[2] = 0.308852842634; sigma[3] = 0.26310785763; sigma[4] = 0.376174586372; sigma[5] = 0.281326906469; sigma[6] = 0.363463449461; sigma[7] = 0.404976192508; sigma[8] = 0.428987999558; sigma[9] = 0.633149241577; sigma[10] = 0.829905097308; sigma[11] = 0.999785191895; sigma[12] = 0.851233590072; sigma[13] = 0.703800929502; sigma[14] = 0.623330941501; sigma[15] = 0.504296736014; sigma[16] = 0.468909453314; sigma[17] = 0.427703071972; sigma[18] = 0.354991559844; sigma[19] = 0.395375319189; sigma[20] = 0.50360760885; sigma[21] = 0.554627701106; sigma[22] = 0.728879695305; sigma[23] = 0.900846204057; sigma[24] = 1.107465344123; sigma[25] = 1.172881752388; sigma[26] = 1.514435197922; sigma[27] = 1.330702997612; sigma[28] = 1.291376685729; sigma[29] = 1.261628064808; sigma[30] = 1.170249769164; sigma[31] = 1.021657978272;
                        votes[0] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.060274485989; theta[1] = -0.05110394253; theta[2] = -0.010059854729; theta[3] = -0.035731932484; theta[4] = -0.068718298836; theta[5] = -0.167285686786; theta[6] = -0.186680368016; theta[7] = -0.082609607641; theta[8] = -0.006310206978; theta[9] = 0.082930356893; theta[10] = 0.483024038719; theta[11] = 0.792250229093; theta[12] = 1.010153840207; theta[13] = 1.251083863274; theta[14] = 1.467516811749; theta[15] = 1.513594427697; theta[16] = 1.775699964751; theta[17] = 1.900438325164; theta[18] = 1.723857181404; theta[19] = 1.695487726174; theta[20] = 1.754993923402; theta[21] = 1.543572017343; theta[22] = 1.393965080724; theta[23] = 1.308204961844; theta[24] = 1.106572681766; theta[25] = 1.000904238008; theta[26] = 1.060071095072; theta[27] = 0.948912454583; theta[28] = 0.798351016185; theta[29] = 0.83380196541; theta[30] = 0.807532215559; theta[31] = 0.727764638262;
                        sigma[0] = 0.471700002783; sigma[1] = 0.438476149281; sigma[2] = 0.628076969906; sigma[3] = 0.689001044693; sigma[4] = 0.53829244918; sigma[5] = 0.384524127094; sigma[6] = 0.312313167188; sigma[7] = 0.280026598187; sigma[8] = 0.338521954949; sigma[9] = 0.59293201071; sigma[10] = 1.34098416347; sigma[11] = 2.331601861284; sigma[12] = 2.42777105789; sigma[13] = 2.862566058449; sigma[14] = 3.069732518372; sigma[15] = 3.202409279418; sigma[16] = 4.301323404499; sigma[17] = 4.908302308885; sigma[18] = 4.613685463657; sigma[19] = 4.939792628402; sigma[20] = 6.147516851448; sigma[21] = 5.524447371722; sigma[22] = 4.797775650774; sigma[23] = 4.67478236554; sigma[24] = 4.060962630066; sigma[25] = 4.303424072761; sigma[26] = 6.545891461922; sigma[27] = 5.285677971746; sigma[28] = 3.713706257231; sigma[29] = 3.548751022623; sigma[30] = 3.466955655288; sigma[31] = 3.063468500888;
                        votes[1] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.804161514567; theta[1] = 0.615747128967; theta[2] = 0.374398417445; theta[3] = 0.27673362851; theta[4] = 0.290375085093; theta[5] = 0.192005496856; theta[6] = 0.155689411164; theta[7] = 0.18540470345; theta[8] = 0.172303105563; theta[9] = 0.069369165955; theta[10] = 0.058557960001; theta[11] = 0.083866614303; theta[12] = 0.101373431156; theta[13] = 0.104312839135; theta[14] = 0.09676530164; theta[15] = 0.120126079788; theta[16] = 0.145543441268; theta[17] = 0.170632037745; theta[18] = 0.133984945807; theta[19] = 0.095625260706; theta[20] = 0.221716863624; theta[21] = 0.171851976614; theta[22] = 0.158198980006; theta[23] = 0.166638860568; theta[24] = 0.114442434248; theta[25] = 0.158197026584; theta[26] = 0.226318670939; theta[27] = 0.179606960594; theta[28] = 0.168461978008; theta[29] = 0.189801522857; theta[30] = 0.188156142852; theta[31] = 0.11938188611;
                        sigma[0] = 1.160103890235; sigma[1] = 1.245843233444; sigma[2] = 1.069060698728; sigma[3] = 1.028984571657; sigma[4] = 0.963299595868; sigma[5] = 0.588666977529; sigma[6] = 0.547905056797; sigma[7] = 0.500063561177; sigma[8] = 0.500985585729; sigma[9] = 0.718155198478; sigma[10] = 0.609829954338; sigma[11] = 0.776165025023; sigma[12] = 0.733720561804; sigma[13] = 0.899249319235; sigma[14] = 0.906267649622; sigma[15] = 1.054445514486; sigma[16] = 1.307134411289; sigma[17] = 1.501663058015; sigma[18] = 1.108530040936; sigma[19] = 1.398507616552; sigma[20] = 2.199519511018; sigma[21] = 1.832282386469; sigma[22] = 1.316298512771; sigma[23] = 1.427874890802; sigma[24] = 0.804324757217; sigma[25] = 0.81035668615; sigma[26] = 0.993687062202; sigma[27] = 0.865018413719; sigma[28] = 0.851224459298; sigma[29] = 0.944410078813; sigma[30] = 0.924312101646; sigma[31] = 0.972491193177;
                        votes[2] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.306006921495; theta[1] = 0.046137240564; theta[2] = 0.083064521406; theta[3] = 0.151580217631; theta[4] = 0.261720441631; theta[5] = 0.152406330059; theta[6] = 0.206963456194; theta[7] = 0.293486625304; theta[8] = 0.321759773041; theta[9] = 0.36768045528; theta[10] = 0.397230152205; theta[11] = 0.363402596784; theta[12] = 0.338575224348; theta[13] = 0.325357865909; theta[14] = 0.370235072891; theta[15] = 0.354166951748; theta[16] = 0.399895316754; theta[17] = 0.421253747442; theta[18] = 0.421072190743; theta[19] = 0.383176909939; theta[20] = 0.345941683572; theta[21] = 0.34891784503; theta[22] = 0.433415302152; theta[23] = 0.370754163191; theta[24] = 0.367775240317; theta[25] = 0.381424703313; theta[26] = 0.406149877974; theta[27] = 0.409379297803; theta[28] = 0.360802755127; theta[29] = 0.368236939746; theta[30] = 0.35518571322; theta[31] = 0.269181298132;
                        sigma[0] = 0.768479502356; sigma[1] = 0.801112973751; sigma[2] = 0.780970677061; sigma[3] = 0.952840880703; sigma[4] = 1.006254575193; sigma[5] = 0.634720599469; sigma[6] = 0.68091172792; sigma[7] = 0.553346509736; sigma[8] = 0.509837974888; sigma[9] = 0.757413998923; sigma[10] = 0.809081823563; sigma[11] = 0.731497204059; sigma[12] = 0.557788002376; sigma[13] = 0.408913973973; sigma[14] = 0.447066247597; sigma[15] = 0.432371466486; sigma[16] = 0.510296019683; sigma[17] = 0.712376666827; sigma[18] = 0.661086366789; sigma[19] = 0.717747684215; sigma[20] = 0.85662387353; sigma[21] = 0.873848632981; sigma[22] = 1.837244344355; sigma[23] = 1.083290274162; sigma[24] = 0.955457508935; sigma[25] = 0.971500099893; sigma[26] = 1.048380775989; sigma[27] = 0.980021841429; sigma[28] = 0.874440325209; sigma[29] = 0.871146479057; sigma[30] = 0.74761860483; sigma[31] = 0.668384554976;
                        votes[3] = 0.25 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 4; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }