#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -0.439916782752 ,-1.175602519421 ,-0.777272934091  };
                        votes[0] += dot(x,   -0.687823333342  , 0.576568896812  , 0.387952723576  , -0.44957778596  , -0.601051115201  , -0.069124311928  , 0.296496020293  , 0.762044023601  , 0.348126558755  , -0.237392354411  , 0.199379712256  , -0.208656169524  , 0.348827694941  , -0.239020039846  , 0.035142626693  , 0.683675696203  , -0.842005531187  , -0.564659622212  , -0.9174355875  , -0.257261981665  , 0.349283363358  , 0.163775104734  , -0.039900778363  , -0.183891198696  , 0.895055046648  , -0.933832313938  , 0.562667937158  , -1.100055669917  , 0.814672873497  , 0.122946222903  , -0.499247136678  , 0.2336236424 );
                        votes[1] += dot(x,   0.03882869598  , -0.054183084145  , -0.292185857003  , 0.471468163775  , -0.083159790906  , -0.131770067836  , -0.132659437257  , 0.003713365288  , -0.857516819025  , -0.330927081202  , -0.249990943594  , 0.189670485635  , 0.257903473561  , 0.271094890614  , -0.094606038226  , -0.235261892399  , 0.778981450067  , 0.462862246795  , -0.454590195514  , 0.096493296992  , 0.3812990961  , -0.016932053732  , -0.241867161454  , 0.412947806655  , -0.251025951366  , -0.1949508909  , -0.360527650662  , 0.677538332769  , -0.093724950828  , -0.269046654746  , -0.046670724481  , 0.466712664674 );
                        votes[2] += dot(x,   0.625270067356  , -0.510652418932  , -0.115950130524  , -0.043958742171  , 0.769174002072  , 0.186049448784  , -0.187565720094  , -0.789429950362  , 0.274403646158  , 0.597268985479  , -0.060208074114  , 0.163015360286  , -0.599751246566  , -0.136799639367  , 0.003330048512  , -0.049348867821  , -0.191843204696  , -0.057057807131  , 0.602357133559  , 0.073561300943  , -0.454433224519  , -0.181322136845  , 0.316314235544  , -0.299282972513  , -0.320877893368  , 0.978737961394  , -0.467324403591  , 0.384286838809  , -0.474987020825  , 0.202004023627  , 0.593292535653  , -0.778567413075 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }