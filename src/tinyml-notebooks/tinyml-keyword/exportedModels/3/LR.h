#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { 0.232678635385 ,-0.308894798548 ,0.076216163164  };
                        votes[0] += dot(x,   -0.464058431395  , 0.395931005651  , 0.291126034553  , -0.355377412877  , -0.350614893184  , -0.057721044979  , 0.167054952672  , 0.498181309706  , 0.352925956503  , -0.134797893282  , 0.209577906107  , -0.209973047619  , 0.241770086788  , -0.259092716681  , 0.038103540806  , 0.609600029634  , -0.656055515226  , -0.347726958167  , -0.731767183558  , -0.160626714493  , 0.269058220533  , 0.150215641117  , 0.000898156484  , -0.173955342636  , 0.679206790857  , -0.742218275978  , 0.454351482018  , -0.831644672547  , 0.607820747562  , 0.109647811314  , -0.384822969868  , 0.159013234783 );
                        votes[1] += dot(x,   0.095067319695  , -0.104713214799  , -0.237110570575  , 0.399819882937  , -0.065252920111  , -0.055395187556  , -0.117432423917  , 0.046097548577  , -0.6479648978  , -0.231626660019  , -0.168899243206  , 0.129650342378  , 0.190015976383  , 0.249592560824  , -0.066769415382  , -0.402134754845  , 0.68049181226  , 0.367969251138  , -0.059471608726  , 0.080840095152  , 0.173592001274  , -0.06318225628  , -0.17433413574  , 0.327239500905  , -0.295300909997  , -0.041845738299  , -0.224471981671  , 0.563269324647  , -0.187519516905  , -0.19966771552  , -0.018442128201  , 0.33237315903 );
                        votes[2] += dot(x,   0.3689911117  , -0.291217790853  , -0.054015463978  , -0.04444247006  , 0.415867813295  , 0.113116232535  , -0.049622528754  , -0.544278858283  , 0.295038941297  , 0.366424553301  , -0.040678662901  , 0.080322705241  , -0.431786063171  , 0.009500155856  , 0.028665874576  , -0.20746527479  , -0.024436297034  , -0.020242292971  , 0.791238792284  , 0.079786619341  , -0.442650221808  , -0.087033384837  , 0.173435979256  , -0.153284158269  , -0.38390588086  , 0.784064014277  , -0.229879500347  , 0.268375347899  , -0.420301230657  , 0.090019904206  , 0.403265098069  , -0.491386393813 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }