#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { -0.016406944798 ,-0.199168097512 ,-0.11418221938 ,0.323743703878 ,0.006013557812  };
                        votes[0] += dot(x,   0.085864275542  , -0.001313166848  , 0.04462689893  , 0.3281660004  , -0.088767864536  , 0.41913596294  , 0.334354243339  , -1.099547029955  , -1.189783108148  , 0.296625831757  , 0.914132935453  , -1.286230464806  , -0.196927100271  , 1.652754389386  , 1.520922372541  , -0.426458789228  , 0.39643612098  , 1.127676924291  , -0.168164773973  , -0.223373116854  , -0.527549690528  , 0.165553045433  , 0.13809867303  , -0.469709390982  , -0.062518407123  , 0.051387268769  , -0.230209929452  , -0.12065618971  , 0.337300992542  , 0.148922652918  , -0.268228059931  , -0.018972219795  , 0.253348387747  , -0.43333077102  , -0.091443692544  , 0.210501476177  , -0.427895573591  , 0.194917309977  , 0.107024429041  , -0.449368196939  , 0.173222170309  , 0.148066748311 );
                        votes[1] += dot(x,   -0.026326610053  , -0.200006213  , 0.04442813622  , -0.053096342738  , 0.01439397837  , -0.039783546522  , 0.277306831071  , -0.125007696337  , -0.300665027231  , 0.23816697583  , -1.106322324946  , 0.725554527431  , -0.054511350815  , -0.263838452874  , -0.163940608932  , 0.418008706241  , 1.329828446658  , -1.194330361324  , -0.040003827521  , 0.772038163912  , -0.175209092608  , -0.045480192965  , -0.014750996521  , 0.546483392608  , -0.171613520605  , 0.004107042334  , 0.61303951422  , -0.057097437283  , 0.10552013563  , -0.0564104141  , 0.142325556986  , 0.423585718009  , -0.128016687608  , 0.215871834561  , 0.357265641636  , -0.156809300173  , 0.161279327299  , 0.313116164015  , -0.06799716308  , 0.19526211305  , 0.265128776542  , -0.186009865111 );
                        votes[2] += dot(x,   0.079480927436  , 0.087619114291  , 0.02103832026  , -0.028206159568  , 0.224955194613  , -0.290560022168  , 0.207181216777  , -0.198687875729  , 1.052364759054  , 0.385530682247  , 0.620611014998  , 0.597399208336  , 0.488387444391  , -0.668056171947  , -1.283288605691  , 0.166728427865  , -0.635338137185  , -0.187335587802  , -0.088307423232  , -0.529681777052  , 0.250422167139  , -0.154148738393  , -0.517953276513  , 0.80032400257  , -0.032975567905  , -0.414762005384  , 0.448022869  , 0.193791355686  , -0.351854593635  , -0.293032674965  , 0.298165935887  , -0.25200170189  , -0.108672035823  , 0.182560669556  , -0.115498398454  , -0.057753869441  , 0.143441893257  , 0.162424619536  , 0.262350461129  , 0.090927009801  , 0.023081400947  , 0.202278510069 );
                        votes[3] += dot(x,   -0.133736451447  , 0.19710119804  , 0.136182420774  , -0.077332798303  , -0.068315851692  , 0.194390450371  , -0.478625423164  , 1.121414536093  , 0.447738423206  , -0.262255866632  , -0.04355112537  , -0.061168195061  , 0.059851828674  , -0.810699254384  , 0.576334702425  , 0.192687101877  , -0.605929892655  , -1.072493813584  , 0.130951111925  , 0.279312119947  , -0.61757498201  , -0.354668474279  , 0.355231184703  , 0.890403514457  , -0.452107889277  , 0.222739195738  , 0.22431061659  , -0.317595208998  , 0.22745826791  , -0.081897698311  , -0.115904803721  , -0.132864117556  , -0.048003960525  , 0.024313292377  , -0.267049535089  , 0.013266012918  , 0.170255507482  , -0.299387746076  , -0.538370843453  , 0.078875384476  , -0.224429670111  , 0.114048912974 );
                        votes[4] += dot(x,   -0.005282141479  , -0.083400932483  , -0.246275776184  , -0.169530699791  , -0.082265456755  , -0.283182844621  , -0.340216868022  , 0.301828065928  , -0.009655046881  , -0.658067623202  , -0.384870500134  , 0.0244449241  , -0.296800821978  , 0.089839489819  , -0.650027860343  , -0.350965446755  , -0.484996537798  , 1.326482838419  , 0.165524912801  , -0.298295389953  , 1.069911598008  , 0.388744360204  , 0.0393744153  , -1.767501518652  , 0.71921538491  , 0.136528498544  , -1.055163070357  , 0.301557480306  , -0.318424802447  , 0.282418134458  , -0.056358629221  , -0.019747678768  , 0.031344296209  , 0.010584974526  , 0.116725984451  , -0.009204319481  , -0.047081154447  , -0.371070347453  , 0.236993116363  , 0.084303689612  , -0.237002677688  , -0.278384306243 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 42);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 42; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }