#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class GaussianNB {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[4] = { 0.0f };
                        float theta[32] = { 0 };
                        float sigma[32] = { 0 };
                        theta[0] = 0.092966233194; theta[1] = 0.048741586863; theta[2] = -0.032486942724; theta[3] = -0.029913169101; theta[4] = 0.064677601958; theta[5] = 0.10753511367; theta[6] = 0.279456342749; theta[7] = 0.406214463029; theta[8] = 0.391998816501; theta[9] = 0.40745075602; theta[10] = 0.305436306809; theta[11] = 0.258514026252; theta[12] = 0.198171537232; theta[13] = 0.079170912583; theta[14] = 0.030490409175; theta[15] = 0.024705449556; theta[16] = -0.023737339496; theta[17] = 0.012035294217; theta[18] = 0.046124436994; theta[19] = 0.104138873159; theta[20] = 0.147983659955; theta[21] = 0.199582923385; theta[22] = 0.252516077052; theta[23] = 0.331794108977; theta[24] = 0.431933435967; theta[25] = 0.493594181615; theta[26] = 0.578645209997; theta[27] = 0.668681655684; theta[28] = 0.727057313896; theta[29] = 0.617130843002; theta[30] = 0.506791681693; theta[31] = 0.274253184246;
                        sigma[0] = 0.36132554708; sigma[1] = 0.344301780991; sigma[2] = 0.186208914734; sigma[3] = 0.169472774398; sigma[4] = 0.185357375191; sigma[5] = 0.221286664818; sigma[6] = 0.293482983487; sigma[7] = 0.31290017133; sigma[8] = 0.339434246; sigma[9] = 0.560893864479; sigma[10] = 0.612379565236; sigma[11] = 0.739535548203; sigma[12] = 0.660708334894; sigma[13] = 0.437467773234; sigma[14] = 0.277717003945; sigma[15] = 0.307199101936; sigma[16] = 0.266359931582; sigma[17] = 0.27747967804; sigma[18] = 0.564196752756; sigma[19] = 1.391516679966; sigma[20] = 2.280383274913; sigma[21] = 3.065609453024; sigma[22] = 2.948127550313; sigma[23] = 5.509710327392; sigma[24] = 7.614159580478; sigma[25] = 8.754705953678; sigma[26] = 10.816343184656; sigma[27] = 12.638486545408; sigma[28] = 13.610739905327; sigma[29] = 9.186762471853; sigma[30] = 4.531325260772; sigma[31] = 1.544157574062;
                        votes[0] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.13413238411; theta[1] = 0.024485565376; theta[2] = 0.0908910504; theta[3] = 0.015581989116; theta[4] = -0.018044354819; theta[5] = -0.182085936637; theta[6] = -0.127574376032; theta[7] = -0.080932973035; theta[8] = -0.004773007304; theta[9] = 0.162198232716; theta[10] = 0.702639663231; theta[11] = 1.117051117932; theta[12] = 1.342100382561; theta[13] = 1.471564856404; theta[14] = 1.668687833514; theta[15] = 1.878151083128; theta[16] = 1.973661630714; theta[17] = 2.047701022771; theta[18] = 2.144504501528; theta[19] = 2.095714707711; theta[20] = 2.237807810138; theta[21] = 2.147875627971; theta[22] = 1.973524091432; theta[23] = 1.956111120872; theta[24] = 1.884070929328; theta[25] = 1.551165541919; theta[26] = 1.369920515889; theta[27] = 1.213805701574; theta[28] = 0.94254107169; theta[29] = 0.93568917419; theta[30] = 0.798033358117; theta[31] = 0.723260617342;
                        sigma[0] = 0.590195912861; sigma[1] = 0.595672171339; sigma[2] = 0.646177959802; sigma[3] = 0.735156824927; sigma[4] = 0.55921767857; sigma[5] = 0.549703756452; sigma[6] = 0.551541092957; sigma[7] = 0.438715730171; sigma[8] = 0.392541102459; sigma[9] = 0.743828612113; sigma[10] = 1.520432910649; sigma[11] = 2.707277086579; sigma[12] = 2.529820604412; sigma[13] = 2.54366444642; sigma[14] = 2.255999199576; sigma[15] = 2.662751405983; sigma[16] = 2.61670107593; sigma[17] = 2.88820088639; sigma[18] = 3.42004202541; sigma[19] = 4.068214188172; sigma[20] = 5.308197076084; sigma[21] = 5.895703672787; sigma[22] = 5.60898880465; sigma[23] = 6.504014777554; sigma[24] = 6.918808799104; sigma[25] = 7.819227324178; sigma[26] = 8.769812636345; sigma[27] = 8.454516362274; sigma[28] = 5.717347628461; sigma[29] = 4.079046741356; sigma[30] = 3.613647304383; sigma[31] = 4.132563005022;
                        votes[1] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.67684566861; theta[1] = 0.507000331058; theta[2] = 0.235101172312; theta[3] = 0.152139931194; theta[4] = 0.179955493609; theta[5] = 0.12434170198; theta[6] = 0.145795285254; theta[7] = 0.193357533485; theta[8] = 0.164774588005; theta[9] = 0.094544530186; theta[10] = -0.001928253646; theta[11] = 0.132768230338; theta[12] = 0.125407648262; theta[13] = 0.031554191802; theta[14] = 0.021464433851; theta[15] = 0.01471120363; theta[16] = 0.004963821749; theta[17] = 0.035851384067; theta[18] = 0.040375198489; theta[19] = -0.003373611924; theta[20] = 0.110651472733; theta[21] = 0.075062105777; theta[22] = 0.112764713406; theta[23] = 0.204634851475; theta[24] = 0.235407745038; theta[25] = 0.304697133932; theta[26] = 0.409487721371; theta[27] = 0.359304007227; theta[28] = 0.399325670117; theta[29] = 0.38957963167; theta[30] = 0.415821880301; theta[31] = 0.266116019759;
                        sigma[0] = 0.812431598543; sigma[1] = 1.263193290759; sigma[2] = 0.830027857931; sigma[3] = 1.061967150858; sigma[4] = 0.906632820444; sigma[5] = 0.715534540708; sigma[6] = 0.74370441867; sigma[7] = 0.587939014846; sigma[8] = 0.513826362435; sigma[9] = 0.898816805914; sigma[10] = 0.605775798127; sigma[11] = 0.794335590813; sigma[12] = 0.565171937151; sigma[13] = 0.449449422116; sigma[14] = 0.24513374094; sigma[15] = 0.284364691881; sigma[16] = 0.252887416378; sigma[17] = 0.223191957114; sigma[18] = 0.304185726018; sigma[19] = 0.307971630508; sigma[20] = 0.623901129655; sigma[21] = 0.666079163331; sigma[22] = 0.53744972504; sigma[23] = 0.849696341716; sigma[24] = 0.767910230946; sigma[25] = 0.894201068178; sigma[26] = 1.117127027278; sigma[27] = 1.166865731499; sigma[28] = 1.229810114017; sigma[29] = 1.256755215796; sigma[30] = 1.463053192472; sigma[31] = 1.368188078736;
                        votes[2] = 0.25 - gauss(x, theta, sigma);
                        theta[0] = 0.26800023908; theta[1] = -0.069760004162; theta[2] = -0.122513261651; theta[3] = -0.167132483035; theta[4] = -0.028764208193; theta[5] = -0.082462678043; theta[6] = 0.009553834822; theta[7] = 0.117904461555; theta[8] = 0.144316569798; theta[9] = 0.170645185398; theta[10] = 0.129148504815; theta[11] = 0.148709571659; theta[12] = 0.165068055483; theta[13] = 0.205392740101; theta[14] = 0.236886044965; theta[15] = 0.256966439058; theta[16] = 0.263527388876; theta[17] = 0.275049544933; theta[18] = 0.304408667123; theta[19] = 0.269546100698; theta[20] = 0.265948224688; theta[21] = 0.240442643396; theta[22] = 0.330693921304; theta[23] = 0.232657616769; theta[24] = 0.275059552221; theta[25] = 0.273510146042; theta[26] = 0.230577143521; theta[27] = 0.259385431676; theta[28] = 0.18416236405; theta[29] = 0.205465730858; theta[30] = 0.236859249761; theta[31] = 0.137721933937;
                        sigma[0] = 0.661409190675; sigma[1] = 0.59155157927; sigma[2] = 0.514906159673; sigma[3] = 0.504597480232; sigma[4] = 0.399387100737; sigma[5] = 0.272892851752; sigma[6] = 0.213999341468; sigma[7] = 0.195025394024; sigma[8] = 0.201218169783; sigma[9] = 0.280957709433; sigma[10] = 0.26649293527; sigma[11] = 0.333111464136; sigma[12] = 0.309981300259; sigma[13] = 0.317665151859; sigma[14] = 0.279853943069; sigma[15] = 0.303942443706; sigma[16] = 0.347908950334; sigma[17] = 0.395838116098; sigma[18] = 0.43933041926; sigma[19] = 0.543519193309; sigma[20] = 0.717931797988; sigma[21] = 0.792101070973; sigma[22] = 2.180941986995; sigma[23] = 0.924388480634; sigma[24] = 1.005886831675; sigma[25] = 1.119410126226; sigma[26] = 0.946716189849; sigma[27] = 0.991095914909; sigma[28] = 0.918575047141; sigma[29] = 0.945476812134; sigma[30] = 0.954618141025; sigma[31] = 0.781339963229;
                        votes[3] = 0.25 - gauss(x, theta, sigma);
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 4; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute gaussian value
                    */
                    float gauss(float *x, float *theta, float *sigma) {
                        float gauss = 0.0f;

                        for (uint16_t i = 0; i < 32; i++) {
                            gauss += log(sigma[i]);
                            gauss += abs(x[i] - theta[i]) / sigma[i];
                        }

                        return gauss;
                    }
                };
            }
        }
    }