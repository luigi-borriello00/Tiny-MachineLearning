#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -0.322257083073 ,-1.8687975307 ,-0.692240384083  };
                        votes[0] += dot(x,   -1.109362846662  , 1.402550945564  , 0.205402543011  , -0.135850052682  , -1.170880883158  , 0.167167791171  , 0.313076900142  , 0.245683733164  , 0.768989355524  , 0.188696448584  , -0.228324466754  , -0.140194818964  , 0.881217551331  , -0.268881537371  , -0.882213218966  , 0.321532346401  , -0.932077895486  , -0.791654125873  , -1.400184825927  , -0.093254688657  , 0.038326510484  , 0.233709637155  , -0.113596669668  , 0.55632297423  , 0.055310717511  , -0.699660791654  , 0.399529825965  , -0.47395194002  , 0.448618011455  , 0.204256593201  , -0.256750840255  , 0.13794382575 );
                        votes[1] += dot(x,   0.575095507824  , -0.887835915667  , -0.420742970896  , 0.942815929166  , 0.50797053746  , -0.310242086159  , 0.448761887049  , -1.025591114763  , -1.168331669107  , -0.899884724767  , 0.645878143697  , 0.577003641004  , 0.087185394813  , -0.092230671029  , -0.043501771704  , -0.063788841207  , 1.200989954785  , 0.972745688685  , -0.384328039762  , -0.370054596489  , 0.501948217382  , 0.85555236943  , -0.681789884418  , -0.511145920207  , 0.531339347915  , -0.210391184921  , -0.593590943744  , 0.494393149503  , -0.008451607157  , 0.222190739776  , -0.645501133584  , 0.732356496693 );
                        votes[2] += dot(x,   0.618997189013  , -0.637256026388  , 0.112918512034  , -0.509580078747  , 0.865285684656  , -0.278363227776  , -0.237480700391  , 0.228321005551  , -0.044509350967  , 0.568361738494  , -0.312315293805  , -0.131330387063  , -0.887521448836  , 0.141368516774  , 0.548503899826  , 0.248591153438  , -0.501874707544  , -0.338083985765  , 0.848146769662  , 0.233097705176  , -0.452616554356  , -0.538401983016  , 0.467353499312  , -0.154686939938  , -0.521976662262  , 0.912800071546  , -0.090002823884  , 0.23770873101  , -0.473953253334  , -0.409841995557  , 1.009404455857  , -0.895654279611 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }