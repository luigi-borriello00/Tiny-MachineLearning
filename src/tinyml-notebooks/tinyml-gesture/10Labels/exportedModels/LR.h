#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[10] = { -0.908437152394 ,0.709684302593 ,2.183209297902 ,-1.903534267627 ,2.150182259074 ,-2.08452428318 ,0.898600383882 ,0.340073839258 ,-0.109599359792 ,-1.275655019716  };
                        votes[0] += dot(x,   -0.157164291402  , -0.276096584698  , -0.226462249063  , 0.060495334277  , -1.177852601285  , 1.008181925729  , -0.009860771015  , -0.995631219166  , -1.322237832335  , -0.015499848369  , 1.310975900774  , -1.986703327304  , -0.519419924706  , 1.930654623056  , 1.070869238598  , -1.455439346234  , 0.222090101576  , 2.11567455939  , -1.353972011884  , -2.11755558267  , 1.737421568948  , -1.342677655267  , -1.420822509582  , -0.839123011898  , -0.668531379109  , -0.254570521991  , -0.786405601118  , -0.606561295707  , 0.242158694812  , 0.895582262644  , -0.802922363532  , -1.16727537057  , 0.299704442667  , -0.643511999963  , -1.072276796455  , -0.132194985491  , -0.745262789728  , -0.333463276776  , -0.002984709108  , -0.835728115534  , -0.06285722602  , 0.198487908079 );
                        votes[1] += dot(x,   0.639521761508  , -0.641063959003  , 0.260357632729  , 0.645722498231  , -1.104372558534  , 0.186439325577  , 1.183595944968  , -0.67996348936  , 1.001714066208  , 1.26302472854  , -1.900814365959  , -1.523372114559  , 1.427113165609  , 0.228271148507  , -2.646523786839  , 0.932138804239  , 1.842377455583  , -0.617149046455  , 0.43999315401  , 1.58816026467  , 1.124183608533  , 0.210545695793  , 0.057021279571  , 0.891905923854  , 1.245211845223  , 1.116479720631  , -1.269610237862  , 1.503753774988  , 0.935376514175  , -0.352298860868  , 1.409350399732  , -0.701886685254  , -0.33476809716  , 1.582745410832  , -0.617713286133  , -0.343176083291  , 1.542418048364  , -0.418693908236  , -0.165565836731  , 1.574661018327  , -0.533622762232  , -0.094844624237 );
                        votes[2] += dot(x,   -0.028969247189  , 0.142555085131  , 0.387448192049  , -0.053221890215  , -0.117032238296  , -0.01310525334  , -0.855158762306  , 0.218159806449  , -1.044245900352  , -0.634631423334  , 2.321883103535  , -0.324427468138  , -1.027729172759  , 0.911948288946  , 2.199790643508  , -0.941070263433  , -0.805329978971  , 1.517368790212  , 1.278449028033  , -0.04946151377  , -1.735104315286  , 2.883252433025  , 0.242568587303  , -2.992891710179  , 2.608423658194  , 0.840592385405  , -1.702184160164  , 1.497798612815  , 0.704100133075  , -0.784998822559  , 0.139551889083  , 0.024455888753  , 0.429204368413  , -0.350458727272  , 0.099093166022  , 0.744634830116  , -0.739781613112  , 0.126367014126  , 0.475896082652  , -0.878066119508  , 0.159910523848  , 0.18819545641 );
                        votes[3] += dot(x,   -0.418715491767  , -0.750970547916  , 0.463813199453  , -0.535628060543  , 1.247664490502  , 0.14478522506  , -0.379932331641  , 0.501740819839  , 0.126430784477  , -0.256666912989  , -1.664876833433  , 0.488442927464  , -1.221751171278  , -2.429837854065  , 0.472492695442  , -0.501259219735  , 0.916461714674  , 0.629741861221  , -0.986383803733  , 2.098084440102  , 0.858358977971  , -1.254018001249  , 0.624239441907  , -0.065605268778  , -0.508826544926  , -0.779655419417  , 0.56046034618  , -0.108475998856  , -1.272825469531  , 0.58968670155  , 0.185120769221  , -0.139100255484  , -0.513344944613  , 0.389466125673  , 0.806406831595  , -0.375913550018  , 0.498845789627  , 1.232124939999  , -0.035445853878  , 0.441298357183  , 1.411236798033  , -0.042786223292 );
                        votes[4] += dot(x,   1.209115651875  , -0.23506101865  , -0.861351005495  , 0.726409021653  , -0.060953465742  , -0.459578183964  , 0.307571864837  , -0.863960424373  , -1.883022416135  , 0.058525110557  , 2.723318514154  , 0.294593633096  , -0.593981794496  , 0.816039804771  , 1.304664799732  , -0.334638664834  , 0.20927198029  , -0.234279743615  , -0.818049138218  , 0.130015227977  , -0.929998612681  , -1.162571766969  , -0.26136436661  , 0.567450982059  , -1.604133194839  , 1.289740202067  , 1.180432389466  , -1.464144506729  , 1.921838957407  , 0.796194536169  , -0.723391443017  , 2.237341184156  , 0.101991501596  , 0.296980208623  , 1.299696291611  , -0.374862157832  , 1.5175148223  , -0.105376564849  , -0.62482899854  , 2.264764387152  , -0.678603534075  , -0.774143182805 );
                        votes[5] += dot(x,   -0.426678162244  , -0.913195296535  , -0.608323262776  , -1.021766596644  , -0.856247572159  , -0.302128919455  , 0.14940786454  , 0.663342056996  , 0.883212025099  , -0.313895246019  , -0.19828234464  , 1.342615719564  , 0.054913606045  , -0.761826398882  , -1.695888209944  , -0.027519999017  , -3.258318035335  , -0.050602781318  , -0.239848511964  , -0.384441949446  , 0.854812368515  , -0.691156054226  , 0.473763242578  , 0.856962210431  , -1.397892693734  , -1.69833552903  , 1.265064505567  , -0.942765553095  , -1.610418741753  , 0.578702572508  , -0.15499615234  , -0.670512939215  , -0.001180405956  , 0.206766657313  , 0.094606573676  , -0.051418487593  , 0.063477270336  , 0.403163050508  , 0.023516773953  , -0.065866967285  , 0.581918446376  , 0.321555124684 );
                        votes[6] += dot(x,   0.074507768594  , 0.649843286571  , 0.129586536998  , 0.605960788234  , 1.213950307297  , 0.29619033388  , -0.221729823752  , -0.517541991406  , 1.631843504209  , 0.848527970375  , 0.038814724399  , -1.037503289384  , 2.98230291362  , 0.859694175298  , -2.695203391154  , 3.561727765115  , 0.821027587751  , -2.31530837413  , 2.107065584105  , 0.520851641206  , -1.33466776711  , 0.815761234618  , 1.346170288981  , 0.232393151658  , -0.272540660384  , -0.255171427639  , 1.207506889145  , -0.311486614841  , -0.56820200418  , 0.795861657288  , -0.173446268975  , -0.060224771355  , 0.120305597502  , -0.025348594741  , 0.306011039999  , -0.100595742007  , -0.083233163032  , 0.602220451507  , -0.02902504596  , -0.178627566601  , 0.770149244081  , -0.067978064752 );
                        votes[7] += dot(x,   0.970681584545  , 0.567387336628  , 0.225723115715  , 1.318381804296  , 0.014918372322  , 0.055419235299  , 1.159479915638  , 0.3919674047  , -1.73448948647  , -0.10313759414  , -1.809013422183  , 0.140461980343  , 0.080466886768  , 0.285498434534  , 3.124931863082  , -0.302917326145  , -0.994983936838  , -0.908292340829  , -0.509857075186  , -2.579537300105  , -0.256444574402  , -0.099108862453  , -0.737577303803  , 1.085454445473  , 0.498949286689  , -0.8589654067  , -0.270204080181  , 0.725811657718  , -2.340616060032  , -1.240485814484  , 0.554337288826  , -2.472550029443  , -0.16304707363  , 0.587785000358  , -1.348301830205  , -0.140172230622  , 0.218604293205  , -1.263036006122  , -0.087522030249  , 0.214917934527  , -1.028097623483  , -0.129001253147 );
                        votes[8] += dot(x,   -1.793452565929  , 1.209764205051  , 0.508474763374  , -1.750884908601  , 1.004496442394  , -0.10317577135  , -1.448853460945  , 0.211059830167  , 1.747644837782  , -0.850288029749  , -0.733864072089  , 1.456284543751  , -0.7561146968  , -0.417679202239  , -0.117788187513  , -0.121295596716  , 1.224296945756  , -1.844375233772  , 0.922508805227  , 0.909872693544  , -2.563529313857  , 0.434319459246  , 1.265019460171  , -0.505894257548  , -0.848142058789  , 0.821566660541  , 1.548371867914  , -1.762872351446  , 0.442426920088  , 0.749321208245  , -1.593765682797  , 0.658873995696  , 0.105825216178  , -1.760300007639  , 0.233873697935  , -0.270901908984  , -1.620647505521  , 0.636125812185  , -0.039828070304  , -1.786982437961  , 0.368043920088  , 0.400113423731 );
                        votes[9] += dot(x,   -0.06884700799  , 0.246837493421  , -0.279266922984  , 0.004532009312  , -0.164571176498  , -0.813027917436  , 0.115479559675  , 1.070827206153  , 0.593150417518  , 0.004041245128  , -0.088141204556  , 1.149607395167  , -0.425799812002  , -1.422763019926  , -1.017345664912  , -0.809726153239  , -0.176893834487  , 1.707222309297  , -0.839906030392  , -0.115987921507  , 2.244968059368  , 0.205653517481  , -1.589018120516  , 0.769347534927  , 0.947481741675  , -0.221680663868  , -1.733431918947  , 1.468942275154  , 1.54616105594  , -2.027565440493  , 1.160161563798  , 2.290878982716  , -0.044690604997  , -0.284124073182  , 0.198604311955  , 1.044600315722  , -0.651935152438  , -0.879431512341  , 0.485787688163  , -0.7503704903  , -0.988077786615  , 0.000401435329 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 10; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 42);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 42; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }