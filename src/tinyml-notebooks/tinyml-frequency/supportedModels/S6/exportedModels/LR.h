#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[11] = { -3.324145056681 ,-3.144150385063 ,-2.280043012519 ,-5.640004377191 ,-2.295629051174 ,-2.277779214407 ,-7.261859129112 ,-2.295987288103 ,-2.573005253125 ,-3.26797108421 ,-2.785935760063  };
                        votes[0] += dot(x,   -0.008157085304  , 0.597603911123  , 0.02276598821  , 0.321905559649  , 0.31393211555  , -0.202884977935  , -0.091596822886  , -0.46850687371  , -0.866537312348  , 0.311995848005  , -0.546890645406  , 0.052002426474  , -0.858133650337  , -0.005230273961  , 0.329837502087  , -0.586253670675  , 0.123483706674  , 0.077649165704  , 0.099872720691  , -0.154354932075  , -0.00053978578  , -0.811621747669  , 0.219755617128  , -0.211599743406  , 0.617947828604  , 0.239888313417  , -0.098385174849  , 0.142497925037  , 0.239468020372  , 0.067751510408  , -0.213373232254  , -0.346860767643 );
                        votes[1] += dot(x,   0.320192791382  , 0.171614031961  , 0.149472309808  , 0.07959099504  , -0.074981246209  , 0.061755327959  , -0.151988435848  , -0.205732390901  , -0.158571047038  , -0.536590064927  , -0.118142339558  , -0.140948216241  , 0.306663207121  , -0.052018126585  , -0.167052651166  , 0.115980299629  , -0.157684919271  , -0.150828723227  , -0.212566848844  , -0.113071209876  , 0.129209157907  , 0.137719421687  , -0.120941901833  , 0.036707371434  , -0.141395022478  , 0.038381050758  , 0.031245990595  , -0.109649096986  , -0.218105311402  , -0.282339863288  , 0.080474833739  , -0.074321278869 );
                        votes[2] += dot(x,   -0.032928500451  , -0.336623755626  , 0.359034388209  , 0.378047156358  , 0.04838573106  , -0.571443438496  , -0.206590369753  , 0.068289934102  , -0.013312598314  , 0.406751688453  , -0.041289370791  , -0.286356137169  , -0.479208718317  , -0.299439255997  , 0.25100820354  , 0.701616557142  , 0.014475357034  , -0.237493341999  , -0.152572572311  , -0.038104389479  , -0.252981424004  , 0.347227825841  , 0.009264173855  , -0.507699541477  , 0.355968821404  , -0.511442047147  , 0.861609341462  , -0.22233937743  , 0.567903162655  , 0.420825717542  , -0.269430872618  , -0.243952944563 );
                        votes[3] += dot(x,   -0.805586589623  , -0.938519198133  , -0.617398029273  , -0.631295554761  , -0.479388826066  , -0.210350569912  , -0.063971311579  , 0.228541389903  , 0.357604419777  , 0.007862158152  , 0.501390209818  , 0.032387945505  , 0.342393454186  , -0.061227776428  , -0.357170373508  , -0.039266703266  , -0.439275753578  , -0.230449469887  , -0.301809712237  , 0.00124033541  , -0.20682898295  , 0.415631257942  , -0.13723392712  , -0.016025230256  , -0.087849020016  , 0.070320419909  , 0.032254062418  , 0.075575470365  , 0.000836634918  , 0.029384882472  , -0.10145458142  , 0.093192024127 );
                        votes[4] += dot(x,   -0.044259455332  , 0.163316533062  , 0.049046209799  , -0.091149997173  , 0.469093357395  , 0.010464624903  , 0.111538140342  , 0.740999080976  , 0.687788159757  , -0.036908082538  , -0.443879964935  , -0.731797736313  , -0.936112786608  , -0.275300114881  , -0.009041403086  , 0.56853516951  , 1.189017125122  , 0.223294125834  , 0.271509209682  , -0.22283368751  , 0.08266110572  , -0.075782906566  , 0.041787159031  , -0.13302584317  , -0.970016094658  , -0.592958911159  , -0.292894666271  , 0.042693244091  , 0.092844326947  , -0.468948355502  , -0.244444362725  , 0.711176654457 );
                        votes[5] += dot(x,   0.274980455964  , 0.152958757022  , 0.20736659466  , 0.030711357992  , 0.084922430918  , -0.00267262634  , -0.253003373001  , -0.279483938277  , -0.314496582828  , -0.288294325367  , 0.075835216618  , -0.274949441977  , 0.143700713011  , 0.123285079795  , 0.029752436872  , -0.062768848109  , 0.090495613482  , 0.016658331895  , 0.078138592363  , -0.150325813748  , -0.048384678263  , 0.193243036458  , 0.061836490923  , 0.133205165382  , -0.058486811644  , 0.16957175576  , -0.022884331252  , -0.186280449153  , -0.091106861205  , 0.00482435238  , 0.118744583338  , 0.146105918946 );
                        votes[6] += dot(x,   0.272627915934  , 0.276054298048  , 0.206950833165  , 0.240496644954  , 0.072719612849  , 0.018517344947  , 0.228963686579  , -0.089331888398  , 0.374960452683  , -0.014988243733  , 0.067651586471  , -0.034521379232  , 0.070608162899  , 0.12440005596  , 0.034397362162  , 0.437600713811  , 0.093296815451  , 0.310071864761  , 0.327737818648  , -0.053253076558  , 0.136092590449  , 0.318932038512  , 0.119181647775  , 0.147422468594  , 0.293219838268  , 0.263510265988  , 0.391827096438  , 0.234991138318  , 0.260754930905  , 0.149324365938  , 0.102147925412  , 0.269257279669 );
                        votes[7] += dot(x,   -0.054180157838  , 0.260414667406  , 0.20376216819  , -0.014716136227  , 0.203993622276  , 0.282000580145  , 0.238151489113  , -0.080225883777  , -0.180014451887  , -0.350416729101  , -0.008238490873  , -0.170814967934  , -0.004170312699  , -0.04312265067  , 0.120922161806  , -0.115977963991  , 0.297639039585  , 0.082127613155  , 0.199734976992  , -0.023915738104  , 0.248527058001  , 0.113251073066  , -0.052960008993  , 0.180229348765  , -0.210842507662  , 0.026646201438  , -0.14813445959  , -0.269720085353  , -0.16106510761  , -0.171743813973  , 0.009464664875  , -0.18185176093 );
                        votes[8] += dot(x,   -0.213001541176  , -0.299242640642  , -0.00058377673  , 0.373680219315  , 0.896590248299  , 0.240267692939  , 0.118856912832  , 0.171693553471  , -0.165121424403  , -0.596916974918  , -0.027473227598  , -0.026507496168  , 0.25469295277  , 0.256273623463  , -0.004404537081  , 0.42139266807  , 0.054555318904  , 0.244028497247  , -0.576942243549  , 0.761091567287  , -0.482568789031  , -0.054728230269  , 0.330917330403  , -0.065197754391  , 0.307840971293  , -0.426645729874  , -0.037261149983  , 0.581559395463  , -0.065079198155  , -0.317402119837  , -0.150649174661  , -0.587603215439 );
                        votes[9] += dot(x,   -0.009143980042  , 0.446572710626  , -0.082864880685  , -0.152898395156  , -0.184371660413  , 0.362890928116  , 0.159029698765  , 0.323881948057  , -0.083706829646  , 0.514431720772  , 0.218671480292  , 0.406142263885  , 0.243038176473  , 0.248823383632  , 0.114339784661  , -0.126391332769  , -0.193115140444  , -0.202239859046  , -0.439938984667  , 0.005265892446  , 0.008764241311  , 0.342451325172  , -0.055948453208  , 0.393463801309  , -0.282710637949  , 0.123081153331  , -0.229140998104  , -0.123994116614  , -0.233264744056  , 0.183746385668  , 0.02811902245  , 0.12147634962 );
                        votes[10] += dot(x,   0.772369514339  , -0.218714088452  , 0.248447359331  , 0.114435275092  , -0.520568741437  , 0.391983362043  , -0.334970770244  , 0.744384647175  , -0.080707693528  , -0.008310189142  , -0.22849722463  , 0.515994714099  , 0.254654908968  , -0.326827082786  , -0.021913855872  , -0.770990483411  , -0.401284463803  , 0.069010763836  , 0.115671420463  , 1.179361627207  , 0.459021760083  , -0.263179527919  , 0.187728049132  , -0.22573202977  , 0.057681018107  , 0.26666048106  , -0.205758358232  , -0.057590895477  , -0.412129645304  , -0.382440214412  , 0.294608849559  , 0.029114605543 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 11; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }