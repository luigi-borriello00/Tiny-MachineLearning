#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[11] = { -3.164217252856 ,0.485370255177 ,6.362759993878 ,-11.047558300299 ,6.322564218429 ,6.343632109912 ,-14.997323064071 ,6.199447263267 ,3.844762955437 ,-2.028298355704 ,1.678860176832  };
                        votes[0] += dot(x,   -0.629045836119  , -0.137400388121  , -0.503751367139  , -0.266223646816  , -0.194787419532  , -0.590198419391  , -0.498035462774  , -0.726170827372  , -1.035851832346  , -0.074912877716  , -0.857115295757  , -0.394793056547  , -1.196930276965  , -0.441005330006  , -0.146284796808  , -0.897012054206  , -0.264589387105  , -0.382577057558  , -0.248872897558  , -0.530883728781  , -0.41055533898  , -1.041736396404  , -0.175830398742  , -0.59829614742  , 0.115629427076  , -0.230557127167  , -0.333827358262  , -0.083250380903  , 0.01699030367  , -0.099459509362  , -0.337862728291  , -0.466682429579 );
                        votes[1] += dot(x,   -0.263138193111  , -0.460313796109  , -0.273314662433  , -0.401452601486  , -0.459557350134  , -0.286122705006  , -0.469737322619  , -0.427971450636  , -0.185023679874  , -0.733974713101  , -0.30418622202  , -0.414909408527  , -0.054837883579  , -0.361202017818  , -0.443336810677  , -0.082770960269  , -0.395076391126  , -0.355339341087  , -0.494533715723  , -0.358366551832  , -0.196839838037  , -0.058793576773  , -0.433196874256  , -0.305980161164  , -0.527825673258  , -0.432663594578  , -0.20396022432  , -0.355548419158  , -0.425148094645  , -0.469568419699  , 0.03880563533  , -0.17651533363 );
                        votes[2] += dot(x,   0.024664664051  , -0.292625579652  , 0.251496183494  , 0.339127605787  , -0.135307291061  , -0.581515920145  , -0.146410714953  , -0.093183207549  , -0.088104124814  , 0.470900523552  , 0.01685753196  , -0.005946318459  , -0.183966329246  , -0.150030306038  , 0.24123515202  , 0.593051821115  , -0.18651397943  , -0.244244007934  , -0.141351888173  , -0.016907906022  , -0.256341838858  , 0.136766767343  , -0.093917137804  , -0.479045568283  , 0.325188212875  , -0.428966253219  , 0.558434963772  , -0.315027190649  , 0.246848909543  , 0.356457732373  , -0.329368322857  , -0.464634244149 );
                        votes[3] += dot(x,   -1.451942674241  , -1.558785171347  , -1.291209223704  , -1.272153504927  , -1.121422080742  , -0.832428401471  , -0.67151922094  , -0.35582635818  , -0.247841825323  , -0.551502498527  , -0.032046555858  , -0.465248571492  , -0.19065939803  , -0.7061427697  , -1.081094068684  , -0.802412256683  , -1.125759012079  , -0.804644608518  , -0.768347161129  , -0.425334329386  , -0.609632961383  , 0.057869904267  , -0.507312854106  , -0.366183385248  , -0.390387760284  , -0.204634947107  , -0.275139393434  , -0.209427308486  , -0.247010720664  , -0.204164484935  , -0.344110411499  , -0.105877124411 );
                        votes[4] += dot(x,   -0.301019207254  , -0.061514772445  , -0.314138662376  , -0.243933813708  , 0.327297867578  , -0.041786224772  , 0.092676779673  , 0.412817815669  , 0.353612229999  , -0.026048880997  , -0.474186763172  , -0.522807628477  , -0.566030322439  , -0.26446244214  , 0.044876167078  , 0.325025653705  , 0.891391616011  , 0.266370257589  , 0.081556035245  , -0.205513147375  , 0.075243437888  , -0.301888879874  , 0.043523677439  , 0.032415675423  , -0.857674886635  , -0.375067867747  , -0.307702148476  , 0.013744339458  , -0.193183585307  , -0.694621444276  , -0.417967188689  , 0.224985876887 );
                        votes[5] += dot(x,   0.316599765  , 0.167769526323  , 0.100957602051  , 0.039871455545  , -0.082934237569  , 0.014192037096  , -0.17459438323  , -0.429515856067  , -0.396185605627  , -0.194989205026  , 0.108691662267  , -0.031226322706  , 0.414664980234  , 0.267736862247  , -0.001913405718  , -0.141350661948  , -0.107199463627  , -0.015345051316  , 0.093908287512  , -0.159151348135  , -0.061243854757  , -0.03182336103  , -0.032864264148  , 0.139151749946  , -0.104215028464  , 0.262111460694  , -0.272697253712  , -0.236067671467  , -0.311306851994  , -0.014903401366  , 0.064004301551  , -0.075749504158 );
                        votes[6] += dot(x,   0.857632637076  , 0.83219849791  , 0.773050831661  , 0.815466272588  , 0.593861114756  , 0.623887425715  , 0.751705032588  , 0.576963193062  , 0.870678626507  , 0.574212453024  , 0.630827734159  , 0.588662887433  , 0.653706892253  , 0.654754676314  , 0.563244507683  , 0.949954203539  , 0.536776907055  , 0.807578591277  , 0.777581391039  , 0.588355339385  , 0.671929030106  , 0.856734353789  , 0.635612718879  , 0.666090515667  , 0.760828980672  , 0.77685618546  , 0.856490332638  , 0.782133342958  , 0.672936877994  , 0.616328972097  , 0.56869862572  , 0.72710516881 );
                        votes[7] += dot(x,   0.08579154184  , 0.34430379416  , 0.140447729522  , -0.048467403304  , -0.07222991663  , 0.264577650743  , 0.242083097436  , -0.206141537921  , -0.177810677214  , -0.208560624453  , 0.083527409392  , 0.060262219651  , 0.218281632656  , 0.095844473878  , 0.057594040148  , -0.196388338753  , 0.08355026949  , 0.004169185841  , 0.265857842203  , -0.077226198152  , 0.300053694688  , -0.005439330796  , -0.085415502405  , 0.214913776139  , -0.203194101382  , 0.15089300127  , -0.354825445401  , -0.296546756828  , -0.291156911701  , -0.057988622823  , 0.035537930515  , -0.242818040396 );
                        votes[8] += dot(x,   0.132423003531  , 0.165497955793  , 0.26445249547  , 0.489676095322  , 0.868551751277  , 0.232688264451  , 0.271588757897  , 0.121799277729  , 0.135072965685  , -0.267496335368  , 0.226804529746  , 0.071112428894  , 0.284165399734  , 0.463122604757  , 0.162396907967  , 0.701490622466  , 0.312507641976  , 0.319721177149  , -0.234192211603  , 0.383632143565  , -0.377731853053  , -0.078599322735  , 0.205738851503  , 0.024258508846  , 0.352207555876  , -0.315958697779  , 0.106241385681  , 0.548029334222  , 0.134279655005  , -0.020245988386  , -0.137074673384  , -0.287243620583 );
                        votes[9] += dot(x,   0.214438327098  , 0.773607670783  , 0.278593311383  , 0.191749247029  , 0.414937603722  , 0.698416520194  , 0.614997454921  , 0.458195172696  , 0.43489989104  , 0.757609455447  , 0.538175400798  , 0.531507219844  , 0.327390245913  , 0.567068819371  , 0.44629619746  , 0.097031276466  , 0.307718946322  , 0.174484113317  , 0.12872687319  , -0.010428495051  , 0.263472145076  , 0.600924186405  , 0.204675717066  , 0.651761809596  , 0.197616076842  , 0.373653170579  , 0.141975617126  , 0.134723372928  , 0.370341113552  , 0.580816952112  , 0.403116839345  , 0.478218950497 );
                        votes[10] += dot(x,   1.01359597213  , 0.227262262705  , 0.573415762072  , 0.35634029397  , -0.138410041665  , 0.498289772585  , -0.012754017999  , 0.669033778567  , 0.336554031966  , 0.254762703166  , 0.062650568486  , 0.583386550386  , 0.294215059469  , -0.125684570866  , 0.15698610953  , -0.546619305433  , -0.052807147487  , 0.229826741238  , 0.539667444996  , 0.811824221782  , 0.601647377311  , -0.134014344192  , 0.238986066573  , 0.020913226499  , 0.331827196682  , 0.424334669596  , 0.085009524387  , 0.017237337926  , 0.026409304546  , 0.007348214265  , 0.45621999226  , 0.389210300712 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 11; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }