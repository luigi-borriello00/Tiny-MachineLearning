#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { 1.992693661412 ,1.708551700351 ,-3.16235489932 ,0.411327116033 ,-0.950217578476  };
                        votes[0] += dot(x,   0.242749388243  , 0.151762492391  , -0.043677881529  , 0.182997102066  , 0.157368384823  , -0.018864983371  , 0.24475213434  , 0.199146977049  , -0.190547711223  , 0.239401372666  , 0.189833022282  , -0.130691288102  , 0.340280812501  , 0.20872024648  , -0.145350204756  , 0.345075171402  , 0.169952635586  , -0.119834965521  , 0.358506839655  , 0.217395305757  , -0.228771209697  , 0.42742047498  , 0.241276109965  , -0.282314423551  , 0.428021450344  , 0.250498446743  , -0.223564083249  , 0.45683142465  , 0.154926777283  , -0.336935387966  , 0.412699379053  , 0.164883404647  , -0.210739912738  , 0.409968061417  , 0.219931439695  , -0.226276196616  , 0.389312090065  , 0.168341471644  , -0.20633168709  , 0.391150882863  , 0.199272415352  , -0.232957558341  , 0.281879572334  , 0.124072620286  , -0.144706197863  , 0.294430391514  , 0.086686769269  , -0.108606667576  , 0.297360324219  , 0.085703550388  , -0.032687802166  , -0.003461806796  , -0.075300099967  , 0.055136732035  , 0.204028998063  , 0.055628724087  , -0.090362234257  , 0.218586957799  , 0.077270206292  , 0.006699643816 );
                        votes[1] += dot(x,   0.471759550748  , 0.242258929446  , -0.075320396538  , 0.276424949427  , 0.137429513578  , -0.048328343019  , 0.355376316687  , 0.17016993794  , -0.255703960184  , 0.466824052296  , 0.261045189184  , -0.194719750302  , 0.618491183954  , 0.352210717669  , -0.260920382329  , 0.531672697166  , 0.234079504913  , -0.239010766491  , 0.628726794196  , 0.202987001195  , -0.345456322705  , 0.861620523246  , 0.413202015138  , -0.493328583721  , 0.756739064811  , 0.220085581746  , -0.50316473328  , 0.847287694341  , 0.29681637867  , -0.508238456141  , 0.677450358622  , 0.21492253271  , -0.417798742423  , 0.86969210265  , 0.218305637965  , -0.440178081842  , 0.805549946234  , 0.368237717434  , -0.42150752825  , 0.630695470497  , 0.171779773125  , -0.395985215037  , 0.63245212975  , 0.17031977027  , -0.385423759244  , 0.576335531025  , 0.262531322998  , -0.285563888516  , 0.45817660058  , 0.035118368909  , -0.212750537782  , 0.234195529339  , -0.016079924121  , -0.023130845039  , 0.333747542942  , 0.069686690782  , -0.145233007524  , 0.406754060342  , 0.085696213561  , -0.179862005039 );
                        votes[2] += dot(x,   0.718596607544  , 1.327861134523  , -0.742151884204  , 0.455312116401  , 0.888124397805  , -0.592731964801  , 0.523149225057  , 0.928732354049  , -0.516537391856  , 0.805655592562  , 1.077483916803  , -0.757047334153  , 0.959522740727  , 1.249649241579  , -0.622779395553  , 1.23897858293  , 1.548736927974  , -0.74219280565  , 1.244850379194  , 1.758909947812  , -0.670912690566  , 1.374954948046  , 2.192988160928  , -0.765530586235  , 1.425259492873  , 2.353303234349  , -1.049817930811  , 1.383831988452  , 2.300723528961  , -0.903931308434  , 1.267307368816  , 2.1566250767  , -0.741876878043  , 1.431449109538  , 2.626845698966  , -0.875951521541  , 1.301079308632  , 2.251494697198  , -1.053611750626  , 1.162687879678  , 1.935481535379  , -0.963644717821  , 1.401286668612  , 1.611784787132  , -0.86882383696  , 1.130926465288  , 1.503072389786  , -0.681601252049  , 0.89662691227  , 1.335518228461  , -0.750667595093  , 0.849845797646  , 1.234600894533  , -0.54478958172  , 0.623940416652  , 1.166562733148  , -0.315521124374  , 1.067656984923  , 1.548385850425  , -0.630808336448 );
                        votes[3] += dot(x,   -0.578728575321  , -0.713229156731  , 0.314378938463  , -0.330147875553  , -0.48678461418  , 0.251574762122  , -0.467130924941  , -0.550383534367  , 0.399891673286  , -0.551803320271  , -0.633078230861  , 0.416394559473  , -0.771994684937  , -0.765820582764  , 0.429383812888  , -0.863259345335  , -0.803280346494  , 0.452640081994  , -0.928062603503  , -0.918157395526  , 0.521501341253  , -1.085428462437  , -1.222614953408  , 0.648896957749  , -1.027626629671  , -1.164658918729  , 0.706444961811  , -1.099924482164  , -1.194877524522  , 0.713177235454  , -1.004734066142  , -1.082218148668  , 0.547049991292  , -1.121318927144  , -1.282312024081  , 0.618650453529  , -0.998193475187  , -1.165059354372  , 0.655009862702  , -0.909004139736  , -1.014387548193  , 0.664014020951  , -0.988497129458  , -0.833535021181  , 0.555773852096  , -0.797210940253  , -0.761690403795  , 0.419397235652  , -0.7111179814  , -0.592033524602  , 0.412355243103  , -0.475047162371  , -0.522361017023  , 0.21210147108  , -0.409943484809  , -0.544972443199  , 0.210665411889  , -0.700007870954  , -0.736134474785  , 0.334893700431 );
                        votes[4] += dot(x,   -0.854376971213  , -1.00865339963  , 0.546771223808  , -0.584586292341  , -0.696137682027  , 0.408350529069  , -0.656146751144  , -0.74766573467  , 0.562897389977  , -0.960077697254  , -0.895283897408  , 0.666063813084  , -1.146300052246  , -1.044759622963  , 0.59966616975  , -1.252467106164  , -1.149488721979  , 0.648398455668  , -1.304021409542  , -1.261134859238  , 0.723638881715  , -1.578567483835  , -1.624851332623  , 0.892276635757  , -1.582393378358  , -1.65922834411  , 1.070101785529  , -1.588026625278  , -1.557589160391  , 1.035927917087  , -1.352723040348  , -1.454212865389  , 0.823365541912  , -1.589790346462  , -1.782770752545  , 0.923755346471  , -1.497747869744  , -1.623014531903  , 1.026441103264  , -1.275530093302  , -1.292146175663  , 0.928573470247  , -1.327121241237  , -1.072642156507  , 0.843179941971  , -1.204481447574  , -1.090600078258  , 0.656374572489  , -0.941045855669  , -0.864306623155  , 0.583750691938  , -0.605532357817  , -0.620859853421  , 0.300682223643  , -0.751773472848  , -0.746905704819  , 0.340450954265  , -0.99299013211  , -0.975217795493  , 0.469076997241 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }