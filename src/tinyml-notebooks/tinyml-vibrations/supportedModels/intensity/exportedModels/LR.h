#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { -1.441661356694 ,-1.627133343076 ,-5.33283980303 ,-1.833085646461 ,-2.960721085477  };
                        votes[0] += dot(x,   0.098662519987  , -0.006807125723  , 0.057071578111  , 0.015684869055  , -0.018757967975  , 0.098256245357  , 0.160832762001  , 0.109423399855  , -0.080288914481  , 0.040775986587  , 0.019049111629  , 0.073814299992  , 0.124872110002  , 0.051465633474  , 0.056298029758  , 0.121690244924  , -0.026550642063  , 0.012809890117  , 0.151450765023  , 0.019299731324  , 0.00761459701  , 0.132446952087  , 0.019969987706  , -0.012329925864  , 0.098935802702  , -0.058803972676  , 0.072512492143  , 0.076541044641  , -0.007774412681  , 0.031885076766  , 0.11780151665  , -0.019644469933  , 0.000608280242  , 0.060270201234  , -0.035683950963  , 0.042355016324  , 0.033466704409  , -0.079814616444  , -0.008726259946  , 0.167673821388  , 0.078161363869  , -0.030230574579  , 0.117953723716  , 0.049522212236  , 0.030301916979  , 0.130788520086  , 0.015630697529  , -0.077593507984  , 0.072652316817  , -0.083424116781  , 0.017114892466  , 0.0103068305  , -0.024815971386  , 0.077351234712  , 0.067959941215  , -0.0021980063  , -0.012435254208  , 0.133925116852  , -0.041472662188  , 0.015462538199 );
                        votes[1] += dot(x,   0.235163341809  , 0.018664645963  , 0.040676492483  , 0.199822235696  , 0.017097304845  , 0.087346995977  , 0.245834849938  , 0.073197865267  , -0.112595437007  , 0.254671159672  , 0.074898863946  , 0.029603495154  , 0.294509139942  , 0.113980510416  , 0.012030510253  , 0.288106507015  , 0.068800349586  , -0.048501354969  , 0.229231146281  , 0.014784651362  , -0.00851837289  , 0.424547416318  , 0.064593532818  , -0.111137490371  , 0.351247962097  , -0.110128554813  , -0.117425619  , 0.411460473091  , 0.066024196876  , -0.185287470367  , 0.302233349695  , -0.053579548708  , -0.184741894172  , 0.442379018922  , -0.054526653607  , -0.113607593732  , 0.376306614447  , 0.056220478895  , -0.188100768281  , 0.318210358096  , -0.05007842574  , -0.139265261097  , 0.365588051991  , 0.083290517957  , -0.141569458413  , 0.376121817917  , 0.130486392227  , -0.214511716609  , 0.159795155892  , -0.159439933081  , -0.098324444531  , 0.181201656271  , -0.009548192183  , 0.036753887334  , 0.179681132989  , -0.018043984961  , -0.051665547512  , 0.239717834977  , -0.158180539057  , -0.01864814057 );
                        votes[2] += dot(x,   0.476952200248  , 1.102988607555  , -0.634602217707  , 0.362388538613  , 0.753397240994  , -0.532261572805  , 0.339296740374  , 0.764189287492  , -0.30505595772  , 0.579546039056  , 0.831358447494  , -0.597073301642  , 0.714124718227  , 1.097865564993  , -0.497974699058  , 0.94023078985  , 1.314066131668  , -0.619467585705  , 0.895954254506  , 1.514456109051  , -0.436107516568  , 0.983885865125  , 1.828114803596  , -0.521294305066  , 1.033034963441  , 2.031880365609  , -0.799422066883  , 0.950271589906  , 1.929298539969  , -0.671065658149  , 1.001443913922  , 1.893799395005  , -0.588164163276  , 1.027345305843  , 2.322942198616  , -0.680131616477  , 0.874809638496  , 1.842324680797  , -0.859392088332  , 0.779534313475  , 1.631385691815  , -0.732915949806  , 1.010314097476  , 1.327354238076  , -0.622616266089  , 0.779656886937  , 1.271799733418  , -0.534280166901  , 0.60477576633  , 1.176603792479  , -0.664108824404  , 0.655581778008  , 1.112803487892  , -0.552635266517  , 0.419191162289  , 1.016630895252  , -0.254415348201  , 0.75801004354  , 1.33944451751  , -0.576236252743 );
                        votes[3] += dot(x,   -0.223475609407  , -0.207769157968  , -0.03049939966  , -0.130970080552  , -0.184603812843  , 0.053190710248  , -0.254270654669  , -0.206932316336  , 0.166846680851  , -0.121649619848  , -0.23984613637  , 0.042499985634  , -0.240974097852  , -0.282008903599  , 0.088585980673  , -0.270545894464  , -0.195805898837  , 0.127191032579  , -0.324642207692  , -0.30853890409  , 0.201134006677  , -0.371676554985  , -0.367303032436  , 0.267387081341  , -0.321464089341  , -0.257099187422  , 0.150730056849  , -0.425426688807  , -0.430664351233  , 0.309137266763  , -0.383385108476  , -0.330946628286  , 0.218602043861  , -0.43180605171  , -0.367540952876  , 0.175136872278  , -0.375609353486  , -0.40237699488  , 0.261060893253  , -0.379123336447  , -0.331350781687  , 0.199493306912  , -0.392298608223  , -0.318077442734  , 0.144461463671  , -0.293810641577  , -0.185128238729  , 0.154912691261  , -0.265846625002  , -0.100095350038  , 0.050236958826  , -0.232907626509  , -0.228367473777  , 0.01126400703  , -0.170596691157  , -0.073939700652  , 0.072319129122  , -0.334810874162  , -0.255904143731  , 0.114069014475 );
                        votes[4] += dot(x,   -0.451274348683  , -0.536882020645  , 0.307315544275  , -0.419424581881  , -0.313759214989  , 0.16127385541  , -0.397306131577  , -0.394220610118  , 0.313436796656  , -0.650283651385  , -0.490708905671  , 0.392428338764  , -0.649064967529  , -0.512030087931  , 0.328403663953  , -0.767895179356  , -0.725412182697  , 0.332334653737  , -0.811260402042  , -0.628913922027  , 0.490267383883  , -0.915567514136  , -0.772953495686  , 0.459746370385  , -1.014553963052  , -1.037979069807  , 0.699592438093  , -0.878782623838  , -0.671615557208  , 0.594265496937  , -0.770567556885  , -0.69552367141  , 0.488637880571  , -0.983956245481  , -0.994969854524  , 0.644698236797  , -0.775651936283  , -0.749633150792  , 0.510888689855  , -0.794475764047  , -0.639943896444  , 0.579029437699  , -0.833255494798  , -0.606560978741  , 0.553824777805  , -0.685843988188  , -0.5721629077  , 0.36447386308  , -0.511295432627  , -0.505628756421  , 0.341521130563  , -0.361132923966  , -0.236537379996  , 0.160711378854  , -0.493027918718  , -0.394997127547  , 0.211682129957  , -0.561304069639  , -0.459547812956  , 0.229806811645 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }