#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[6] = { 0.543598102187 ,-0.214583422439 ,-1.078138428637 ,-0.129697235922 ,-1.170293711683 ,-0.13270324288  };
                        votes[0] += dot(x,   -1.776204276352  , 1.675602412039  , -0.22470017019  , -1.964189328094  , 1.429620720254  , -0.261964020076  , -1.845382448029  , 1.346092879964  , -0.182084210459  , -1.935528393539  , 1.302892231324  , -0.347477163333  , -1.877689956885  , 1.324354443073  , -0.156917418067  , -2.00777810302  , 1.312855187828  , -0.147456915915  , -1.971807213315  , 1.670358481606  , -0.282042689689  , -2.101842241666  , 1.35692662613  , -0.355176091096  , -2.000407284216  , 1.397560245669  , -0.332236213985  , -1.659411953522  , 1.624746053378  , -0.060939663628  , -1.988712250948  , 1.368124540452  , -0.252585952134  , -1.903028124378  , 1.270359531715  , -0.299603677798  , -2.06263963204  , 1.219311557718  , -0.198356207247  , -1.927560031391  , 1.504560233819  , -0.259859332808  , -2.034612598721  , 1.158126362848  , -0.207828816437  , -2.09363449033  , 1.370513777752  , -0.27490712911  , -1.979208202691  , 1.03581993084  , -0.180446551466  , -1.928676062496  , 1.281071477318  , -0.070834647667  , -2.023719746887  , 1.152514272721  , -0.077868143765  , -2.06751936909  , 1.398309717201  , -0.171021913945 );
                        votes[1] += dot(x,   -5.560697787202  , -2.645009405778  , -0.476825270861  , -5.543106584802  , -2.664027438414  , -0.483401741663  , -5.527815519465  , -2.658812570091  , -0.511962195378  , -5.487156351972  , -2.670179354892  , -0.440190147536  , -5.399704832106  , -2.74373278793  , -0.463425515863  , -5.460582730668  , -2.575626385829  , -0.3968421763  , -5.397625087796  , -2.689156813007  , -0.386449501533  , -5.465092386098  , -2.617103874809  , -0.378790896371  , -5.502861314625  , -2.714636094725  , -0.426747606451  , -5.483248029033  , -2.665967741808  , -0.419244363331  , -5.425377359213  , -2.783157595187  , -0.420812003513  , -5.369046531845  , -2.670364995501  , -0.321037691061  , -5.386078398881  , -2.582666970021  , -0.282331623686  , -5.382564695419  , -2.485775510048  , -0.249972128406  , -5.432799977525  , -2.548914293075  , -0.258397503206  , -5.408939646965  , -2.55466778326  , -0.255569306765  , -5.387703374411  , -2.706483317836  , -0.345804002539  , -5.474296724113  , -2.669800517038  , -0.308661107153  , -5.417839823232  , -2.820351780183  , -0.419383830548  , -5.457128306144  , -2.876799137977  , -0.518680390087 );
                        votes[2] += dot(x,   -0.37758696226  , -3.527037207285  , -0.016095862545  , -0.509895640878  , -3.266124867787  , 0.032964474881  , -0.439367620791  , -3.26703381663  , 0.136478787264  , -0.540995213872  , -2.991726445393  , 0.028425275368  , -0.605963730349  , -2.937660648931  , 0.063251172849  , -0.413091550722  , -3.413653712137  , -0.13399241358  , -0.471567200737  , -3.05053987453  , -0.008650700797  , -0.382769116499  , -3.246905911951  , -0.076458337619  , -0.366250705694  , -3.352141688961  , 0.013691527098  , -0.452853170738  , -3.374588717541  , -0.095104976418  , -0.377008114442  , -3.177695201299  , 0.008913885703  , -0.428698639448  , -3.310245302034  , -0.160704863995  , -0.45600723044  , -3.475654930345  , -0.160529825319  , -0.379976995278  , -3.460073291402  , -0.17373608072  , -0.477228931717  , -3.507971571431  , -0.189574066956  , -0.534545320355  , -3.355911863893  , -0.157603200908  , -0.463344638581  , -2.966387019435  , -0.075241665  , -0.331562802534  , -3.356714408001  , -0.173519806808  , -0.416634898142  , -3.456335646338  , -0.194324768186  , -0.227502489139  , -3.71606314378  , -0.236577671952 );
                        votes[3] += dot(x,   0.933705368118  , 4.468290996648  , -0.181456474631  , 0.957476410856  , 4.493451778245  , -0.167629455025  , 0.914593425155  , 4.513448565511  , -0.198769559493  , 0.891850686102  , 4.490647928276  , -0.124673736362  , 0.855234440006  , 4.517590940486  , -0.21333044317  , 0.902411087687  , 4.514897763443  , -0.209663720488  , 0.892307117981  , 4.468987060526  , -0.160898307665  , 0.941992281267  , 4.492234452802  , -0.168720566577  , 0.857074178497  , 4.435142740814  , -0.185515254707  , 0.811309566437  , 4.418069988654  , -0.253888118972  , 0.893614701755  , 4.481143317046  , -0.249560637507  , 0.893155654438  , 4.503001927784  , -0.240504918082  , 0.872322129745  , 4.492676238305  , -0.278677554844  , 0.876905225619  , 4.4523189718  , -0.255431198188  , 0.876858770046  , 4.47142380212  , -0.289699915352  , 0.89062889135  , 4.472004001545  , -0.280501352753  , 0.837523079742  , 4.486613891174  , -0.332909171259  , 0.804572296247  , 4.467799613113  , -0.310373660301  , 0.792248973693  , 4.50854935674  , -0.377038093784  , 0.777035221656  , 4.483649352518  , -0.365392827702 );
                        votes[4] += dot(x,   -2.049740055636  , 0.539811770046  , -0.085133864294  , -2.050174732303  , 0.352723550617  , -0.191347763095  , -2.172420713107  , 0.575653485484  , -0.018016365074  , -1.943408669602  , 0.201413036004  , -0.190779777759  , -2.113798690978  , 0.137067067435  , -0.158469030208  , -2.14240621655  , 0.547231295735  , -0.002496997811  , -2.036336095277  , 0.018887612035  , -0.25396200227  , -1.978335779709  , 0.172811504936  , -0.227447169493  , -1.872211929181  , 0.464755681441  , -0.061686692074  , -1.719668696192  , 0.372367018933  , -0.079802934456  , -2.122435230332  , 0.327459946443  , -0.063594063251  , -2.154245141065  , 0.218125721379  , -0.099849596788  , -2.012429612607  , 0.296706982695  , -0.092383910493  , -1.931701030474  , -0.232576394646  , -0.205912253585  , -1.772784400303  , 0.258479840138  , -0.122005083437  , -1.892197678883  , -0.101624219767  , -0.259055880606  , -1.977315396085  , -0.13015704963  , -0.164808522333  , -1.911433343374  , 0.352135442107  , 0.024090646748  , -1.962970699965  , 0.289420473585  , 0.027816246489  , -2.051143163761  , 0.270969976278  , 0.088052928232 );
                        votes[5] += dot(x,   4.809700368887  , -2.342368958852  , 0.00949090781  , 4.811323412495  , -2.282828532582  , 0.152788536936  , 4.783732262931  , -2.308009246171  , 0.025833724875  , 4.866570920144  , -2.236448136061  , 0.097219316587  , 4.863414179316  , -2.271329096377  , 0.081425753626  , 4.796777521274  , -2.247005032619  , 0.083571742716  , 4.866709064304  , -2.250657084985  , 0.036146043188  , 4.815701524037  , -2.266117744646  , 0.077437150826  , 4.869290673799  , -2.27547710986  , 0.002298232526  , 4.827251733457  , -2.227626876171  , 0.104690838999  , 4.839414768239  , -2.287189055149  , 0.036655066069  , 4.833126004386  , -2.281960521688  , 0.018911650947  , 4.842928142553  , -2.320190789664  , 0.065287634023  , 4.776033980373  , -2.290642918097  , 0.029077970521  , 4.80416590704  , -2.345837295419  , 0.012120456015  , 4.916083074703  , -2.272016339482  , 0.021061668179  , 4.85815520272  , -2.259040903394  , 0.045424725546  , 4.741432119585  , -2.263743374206  , -0.012545503814  , 4.888746370204  , -2.202853758403  , -0.005299422851  , 4.903698994373  , -2.204713157041  , -0.007305783237 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 6; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }