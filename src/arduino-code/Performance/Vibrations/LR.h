#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[5] = { -2.454005986478 ,-2.403396371192 ,-4.095693393659 ,-1.284661446977 ,-2.275586073839  };
                        votes[0] += dot(x,   0.197743983226  , 0.069616804745  , 0.036090466035  , 0.048634276125  , -0.038356182189  , 0.180914334877  , 0.096230828585  , 0.039707806832  , 0.039758171568  , 0.192400372027  , 0.152186475404  , -0.004816238632  , 0.036162025048  , -0.053296160666  , 0.075771631673  , 0.185275069486  , -0.007125897004  , 0.030970900447  , 0.185778888658  , 0.061753868893  , 0.034694651156  , 0.100682806056  , -0.11166432527  , 0.0654909  , 0.272213287945  , -0.047942047698  , -0.095484758884  , 0.271262991382  , -0.120516401644  , -0.153104412596  , 0.052542534097  , -0.028587067698  , 0.060269220337  , 0.147000860133  , 0.017120476046  , 0.075711462735  , 0.21589454821  , -0.13726539292  , -0.101585005881  , 0.27345366335  , -0.007218870677  , -0.186173882611  , 0.070436111188  , 0.041234870866  , -0.019296117294  , 0.16867377236  , -0.115908578725  , -0.022461228526  , 0.25304318759  , 0.020978660989  , -0.103548949252  , 0.086290576488  , -0.066716523695  , -0.049379610071  , 0.204468461039  , -0.053218844601  , -0.005914697611  , 0.237470822648  , -0.057998939789  , 0.035012555858 );
                        votes[1] += dot(x,   0.155259546148  , 0.015206605009  , 0.035245774465  , -0.016091344156  , -0.011530063814  , 0.088579663765  , 0.148273848772  , -0.046118249494  , -0.049600202392  , 0.158687957508  , 0.109450744302  , 0.023178312812  , 0.079778298226  , 0.014064582205  , 0.041286849788  , 0.129049782198  , 0.057892419105  , 0.012146909265  , 0.368199672145  , 0.021547971158  , -0.12118000053  , 0.129095715907  , -0.065597941604  , -0.026155194607  , 0.191673539014  , -0.025500230645  , -0.101158616935  , 0.205583267409  , 0.019820974609  , -0.084195742747  , 0.248423445567  , 0.025332637442  , -0.05759119035  , 0.369064338393  , 0.05969993075  , -0.152104059278  , 0.20549912767  , -0.069688405833  , -0.096606822623  , 0.227760532557  , 0.019318556146  , -0.136789627674  , 0.271865661112  , 0.068648424762  , -0.087889477008  , 0.246411474644  , 0.080393167915  , -0.102629110696  , 0.127930947518  , -0.045365373954  , -0.089529319807  , 0.128099386641  , -0.020863595573  , -0.061272209365  , 0.166902459102  , -0.020712967809  , -0.046918481405  , 0.072107158157  , -0.038356647826  , -0.010343891101 );
                        votes[2] += dot(x,   0.449041954474  , 1.23617689076  , -0.672219258089  , 0.312886694769  , 0.815811456943  , -0.557715835314  , 0.562274394134  , 0.843386630035  , -0.423024108345  , 0.704289343676  , 0.964327850857  , -0.573952826861  , 0.734704559277  , 1.04932519627  , -0.440648757587  , 0.927791376511  , 1.140191931566  , -0.555443222628  , 0.897319889409  , 1.389446151394  , -0.533044135406  , 1.027784081827  , 1.788350858313  , -0.611803923873  , 1.109079964271  , 1.95596508476  , -0.634531106844  , 1.103934866715  , 1.848490641301  , -0.743408904546  , 0.914669083765  , 1.639395505922  , -0.724301887951  , 0.885291217852  , 2.076744141381  , -0.879648348147  , 0.850960773551  , 1.678189657153  , -0.635197384696  , 0.80825855604  , 1.523686497208  , -0.795050588094  , 0.774874114356  , 1.094246296835  , -0.691173993269  , 0.705125423282  , 1.025803172018  , -0.534412385891  , 0.638886040953  , 0.977194578038  , -0.480133656722  , 0.559314295301  , 1.009526059146  , -0.52603790501  , 0.4888169026  , 0.737124960227  , -0.294886108524  , 0.762701385922  , 1.601750495032  , -0.445893141004 );
                        votes[3] += dot(x,   -0.123484111112  , -0.237301331056  , 0.065437581484  , -0.111982194278  , -0.131790831297  , 0.051662373144  , -0.16809618515  , -0.220433266291  , 0.050297275796  , -0.112601559327  , -0.207356511659  , 0.064973867939  , -0.186942617957  , -0.218709714781  , 0.11853444853  , -0.237056437643  , -0.272752631287  , 0.105937812624  , -0.309262935999  , -0.285231701311  , 0.121236988208  , -0.207206730732  , -0.226249764739  , 0.141995884292  , -0.280743681142  , -0.354873050483  , 0.140765059168  , -0.271634772871  , -0.262668249693  , 0.160122584072  , -0.297767696827  , -0.26858078992  , 0.110117625191  , -0.26232636644  , -0.356758655466  , 0.139485127362  , -0.24581440258  , -0.201636611396  , 0.190351953697  , -0.277097262264  , -0.292318132465  , 0.164733031068  , -0.195227774007  , -0.196011029712  , 0.089620827464  , -0.194250092649  , -0.168905911117  , 0.090044747987  , -0.295580856309  , -0.165611623405  , 0.168068112303  , -0.078301108473  , -0.071705455139  , 0.04532968924  , -0.109443435667  , -0.059683901112  , 0.033850765631  , -0.136817307818  , -0.11376224983  , -0.073365252842 );
                        votes[4] += dot(x,   -0.474927308102  , -0.521651919129  , 0.229706655295  , -0.193740498828  , -0.274696946791  , 0.158450800728  , -0.359304167117  , -0.296026621299  , 0.327796236876  , -0.554534692489  , -0.439886098948  , 0.291030716955  , -0.43298813945  , -0.483816900664  , 0.183816616063  , -0.551705709379  , -0.412752025786  , 0.300364994553  , -0.567247642504  , -0.588122167615  , 0.382650738919  , -0.768222021284  , -0.79099340317  , 0.468881754575  , -0.819826741657  , -0.758397925885  , 0.6119337775  , -0.631907862654  , -0.606874474761  , 0.479024029254  , -0.540652020724  , -0.704895110334  , 0.468862371148  , -0.754373559972  , -0.804400861388  , 0.497745288095  , -0.742727819906  , -0.744388054082  , 0.51620422891  , -0.637136799793  , -0.607606131647  , 0.537665491589  , -0.54923520793  , -0.512287146282  , 0.40392795026  , -0.593326259093  , -0.520303080346  , 0.337324512119  , -0.315576624975  , -0.38447544554  , 0.191398767357  , -0.437531464946  , -0.332933504888  , 0.245037675116  , -0.434977116086  , -0.329473056329  , 0.138531342235  , -0.522817947137  , -0.511937268287  , 0.320137149201 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 5; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 60);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 60; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }