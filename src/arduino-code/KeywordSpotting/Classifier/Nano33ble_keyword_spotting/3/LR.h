#pragma once
#include <cstdarg>
namespace Eloquent {
    namespace ML {
        namespace Port {
            class LogisticRegression {
                public:
                    /**
                    * Predict class for features vector
                    */
                    int predict(float *x) {
                        float votes[3] = { -0.302828585473 ,-1.638582662063 ,-0.664220704473  };
                        votes[0] += dot(x,   -0.97596943647  , 1.274569800815  , 0.13780556481  , -0.163848733915  , -0.836441044487  , 0.283982580278  , 0.075700105106  , 0.152405565349  , 0.913467910267  , -0.011597153155  , 0.074993601207  , -0.083976101999  , 0.278399682324  , -0.090351500485  , -0.306612571075  , -0.022258577756  , -0.804017873216  , -0.965242910566  , -1.151104639703  , -0.151590062033  , 0.091992656631  , 0.1234965125  , -0.152637020894  , 0.441108359395  , 0.219165976899  , -0.529126572734  , -0.078456116332  , -0.716813401583  , 0.962314314172  , -0.020743448244  , 0.073485496282  , 0.208774858613 );
                        votes[1] += dot(x,   0.428914825151  , -0.533326709425  , 0.032535795225  , 0.572769810699  , 0.05339312233  , -0.2326623052  , 0.454245322755  , -0.776086114094  , -0.874647597165  , -0.647845880656  , 0.204151228749  , 0.06262149225  , 0.249762282312  , 0.396413833756  , -0.031030268804  , 0.2885913823  , 0.685613948842  , 0.908427972308  , 0.078832835987  , -0.644541283974  , 0.323126714684  , 0.329165270088  , -0.273727778983  , -0.250290239084  , 0.085731308809  , -0.154130654868  , 0.32603650819  , 0.290592339471  , -0.431307649424  , 0.35168962019  , -0.613002563024  , 0.245149215041 );
                        votes[2] += dot(x,   0.518256988268  , -0.72173351411  , -0.056210339142  , -0.361711198824  , 0.984944180466  , -0.202283194971  , -0.357372998082  , 0.338491635197  , -0.303096857235  , 0.364801719269  , -0.133438045159  , 0.232980777045  , -0.791290049363  , -0.09123702178  , 0.175974906513  , 0.030201152553  , -0.154324850451  , -0.226533326691  , 0.159995549689  , 0.607950593766  , -0.474101693331  , -0.098151498748  , 0.423090964544  , -0.307739689628  , -0.230678616783  , 0.603558106774  , -0.530309049516  , 0.571058929112  , -0.46803486952  , -0.26380723697  , 0.563542690785  , -0.438153694453 );
                        // return argmax of votes
                        uint8_t classIdx = 0;
                        float maxVotes = votes[0];

                        for (uint8_t i = 1; i < 3; i++) {
                            if (votes[i] > maxVotes) {
                                classIdx = i;
                                maxVotes = votes[i];
                            }
                        }

                        return classIdx;
                    }

                protected:
                    /**
                    * Compute dot product
                    */
                    float dot(float *x, ...) {
                        va_list w;
                        va_start(w, 32);
                        float dot = 0.0;

                        for (uint16_t i = 0; i < 32; i++) {
                            const float wi = va_arg(w, double);
                            dot += x[i] * wi;
                        }

                        return dot;
                    }
                };
            }
        }
    }